import{K as M,r,j as s,L as A,$ as p,S as i}from"./app-OMiIBAVv.js";import{S as L,a as X}from"./AdminLayout-CUYq8DRk.js";import{B as N}from"./button-DSR4zr8t.js";import{I as B}from"./input-BGuCCM3F.js";import z from"./BreadcrumbsHeader-D7yXDAqZ.js";import{t as y,T as K}from"./index-0Qv22I-m.js";import"./table-Btx8o7Vo.js";import"./dropdown-menu-Bvu9yf_7.js";import $ from"./DynamicTable-UkXv7no2.js";import V from"./ActionMenu-BwZQbtv1.js";import{r as G,s as Q,t as W,u as Y}from"./constants-iESbBslm.js";import{F as J}from"./FillterToggle-DNCt5F0M.js";import"./label-CpR9uzLH.js";import Z from"./DynamicTableControls-D0m5fsZs.js";import P from"./DeleteConfirmationModal-TJ1uBlKB.js";import{E as v}from"./ExportButton-D1HLyQQo.js";import{H as q}from"./users-round-DM5XvS4t.js";import{S as ee}from"./search-B5GIhMYd.js";import{H as se}from"./house-plus-CFlL9Fwu.js";import{E as oe}from"./eye-Wkg7vRqS.js";import{S as te}from"./square-pen-CIUQNKLN.js";import{T as re}from"./trash-2-jR1sYQPd.js";import{U as le}from"./user-DaJigm7H.js";import"./sidebar-8I0oMIHa.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-CI6SsBKC.js";import"./index-BLQZ4u8d.js";import"./floating-ui.react-dom-CMRH_ZRG.js";import"./x-CWRGpm6F.js";import"./createLucideIcon-Axl_0YCz.js";import"./skeleton-B3ns0wAt.js";import"./tooltip-DovJGv4D.js";import"./nav-user-CHo7Aeqf.js";import"./avatar-EoKRnGG_.js";import"./useAppUrl-D_iSPAaw.js";import"./heart-pulse-BEye5CQy.js";import"./chevron-up-aIKK6lnp.js";import"./breadcrumb-BupgMzbl.js";import"./chevron-right-Cy23RFOt.js";import"./check-CuPlmUjy.js";import"./ellipsis-PuzZ1_TO.js";import"./file-output-BYH2ausi.js";function qe({households:S,puroks:k,streets:H,queryParams:t}){const O=[{label:"Residents Information",showOnMobile:!1},{label:"Households",showOnMobile:!0}];t=t||{};const l=M().props,n=(l==null?void 0:l.success)??null,u=(l==null?void 0:l.error)??null,[x,E]=r.useState(t.name??""),[T,d]=r.useState(!1),[b,D]=r.useState(null),C=e=>{e.preventDefault(),m("name",x)},m=(e,o)=>{o&&o.trim()!==""?t[e]=o:delete t[e],t.page&&delete t.page,i.get(route("household.index",t))},I=(e,o)=>{if(o.key==="Enter")m(e,o.target.value);else return},a=[{key:"id",label:"ID"},{key:"name",label:"Name of Household Head"},{key:"house_number",label:"House Number"},{key:"purok_number",label:"Purok"},{key:"street_name",label:"Street"},{key:"ownership_type",label:"Ownership Type"},{key:"housing_condition",label:"Housing Condition"},{key:"year_established",label:"Year Established"},{key:"house_structure",label:"House Structure"},{key:"number_of_rooms",label:"Number of Rooms"},{key:"number_of_floors",label:"Number of Floors"},{key:"number_of_occupants",label:"Number of Occupants"},{key:"actions",label:"Actions"}],[c,f]=r.useState(a.map(e=>e.key));r.useEffect(()=>{c.length===0&&f(a.map(e=>e.key))},[]);const[ae,ie]=r.useState(!0),[ne,ue]=r.useState(!1),h=Object.entries(t||{}).some(([e,o])=>["purok","street","own_type","condition","structure"].includes(e)&&o&&o!=="");r.useEffect(()=>{h&&j(!0)},[h]);const[g,j]=r.useState(h),F={id:e=>{var o;return(o=e.household)==null?void 0:o.id},name:e=>{const o=e.resident;return o?s.jsxs(p,{href:route("resident.show",o.id),children:[o.firstname," ",o.middlename??""," ",o.lastname??""," ",o.suffix??""]}):s.jsx("span",{className:"text-gray-400 italic",children:"No household head"})},house_number:e=>{var o;return s.jsxs(p,{href:route("household.show",(o=e.household)==null?void 0:o.id),className:"hover:text-blue-500 hover:underline",children:[" ",e.household.house_number]})},purok_number:e=>e.household.purok.purok_number,street_name:e=>e.household.street.street_name,ownership_type:e=>s.jsx("span",{children:Y[e.household.ownership_type]}),housing_condition:e=>s.jsx("span",{className:`px-2 py-1 text-sm rounded-lg ${W[e.household.housing_condition]??"bg-gray-100 text-gray-700"}`,children:Q[e.household.housing_condition]}),year_established:e=>e.household.year_established??"Unknown",house_structure:e=>s.jsx("span",{children:G[e.household.house_structure]}),number_of_rooms:e=>e.household.number_of_rooms??"N/A",number_of_floors:e=>e.household.number_of_floors??"N/A",number_of_occupants:e=>{var o,_,w;return s.jsxs("span",{className:"flex items-center",children:[((w=(_=(o=e==null?void 0:e.household)==null?void 0:o.residents_count)==null?void 0:_[0])==null?void 0:w.aggregate)??0," ",s.jsx(le,{className:"ml-2 h-5 w-5"})]})},actions:e=>s.jsx(V,{actions:[{label:"View",icon:s.jsx(oe,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>{var o;return i.visit(route("household.show",(o=e.household)==null?void 0:o.id))}},{label:"Edit",icon:s.jsx(te,{className:"w-4 h-4 text-green-500"}),onClick:()=>{var o;return i.visit(route("household.edit",(o=e.household)==null?void 0:o.id))}},{label:"Delete",icon:s.jsx(re,{className:"w-4 h-4 text-red-600"}),onClick:()=>{var o;return R((o=e.household)==null?void 0:o.id)}}]})},R=e=>{D(e),d(!0)},U=()=>{i.delete(route("household.destroy",b)),d(!1)};return r.useEffect(()=>{n&&y.success(n,{description:"Operation successful!",duration:3e3,closeButton:!0}),l.success=null},[n]),r.useEffect(()=>{u&&y.error(u,{description:"Operation failed!",duration:3e3,closeButton:!0}),l.error=null},[u]),s.jsxs(L,{children:[s.jsx(A,{title:"Households Dashboard"}),s.jsx(z,{breadcrumbs:O}),s.jsx(K,{richColors:!0}),s.jsx("div",{className:"pt-4",children:s.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:s.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[s.jsx("div",{className:"p-2 bg-indigo-100 rounded-full",children:s.jsx(q,{className:"w-6 h-6 text-indigo-600"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Households Records"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Manage all registered households in the barangay. Search, filter, or export data, and add new households for accurate community tracking."})]})]})}),s.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[s.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[s.jsx(Z,{allColumns:a,visibleColumns:c,setVisibleColumns:f,showFilters:g,toggleShowFilters:()=>j(e=>!e)}),s.jsx(v,{url:"report/export-household-excel",queryParams:t,label:"Export Households as XLSX"}),s.jsx(v,{url:"report/export-householdmembers-excel",queryParams:t,icon:s.jsx(X,{}),label:"Export Household Members as XLSX"})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[s.jsxs("form",{onSubmit:C,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[s.jsx(B,{type:"text",placeholder:"Search for Household Member Name",value:x,onChange:e=>E(e.target.value),onKeyDown:e=>I("name",e),className:"w-full"}),s.jsxs("div",{className:"relative group z-50",children:[s.jsx(N,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:s.jsx(ee,{})}),s.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),s.jsx(p,{href:route("household.create"),children:s.jsxs("div",{className:"relative group z-50",children:[s.jsx(N,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:s.jsx(se,{className:"w-4 h-4"})}),s.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Household"})]})})]})]}),g&&s.jsx(J,{queryParams:t,searchFieldName:m,visibleFilters:["purok","street","own_type","condition","structure"],showFilters:!0,puroks:k,streets:H,clearRouteName:"household.index",clearRouteParams:{}}),s.jsx($,{passedData:S,allColumns:a,columnRenderers:F,queryParams:t,visibleColumns:c,showTotal:!0}),s.jsx(P,{isOpen:T,onClose:()=>{d(!1)},onConfirm:U,residentId:b})]})})})]})}export{qe as default};

import{K as X,r as o,j as t,L as G,$ as P,S as l,a as Q}from"./app-BDFxb8TA.js";import{S as Z}from"./AdminLayout-CM3_VNfS.js";import{B as D}from"./button-CpOsaw8_.js";import{I as J}from"./input-jJkVEZh6.js";import W from"./BreadcrumbsHeader-BjgQDL1u.js";import{t as C,T as Y}from"./index-BV4yT7DH.js";import"./table-Dk-49AVr.js";import"./dropdown-menu-enabQI5J.js";import q from"./DynamicTable-CHhkyrvT.js";import ee from"./ActionMenu-B1t3zEf2.js";import{G as te}from"./constants-a7o6YRsm.js";import"./react-datepicker-bgVyIYaD.js";import"./label-Cr4gGsEA.js";import{u as se}from"./useAppUrl-8JzvxBJd.js";import re from"./FillterToggle-D90xyrDX.js";import oe from"./DynamicTableControls-Be3FEhX9.js";import ae from"./DeleteConfirmationModal-BmD4yp-x.js";import ie from"./SidebarModal-BzXA3oBB.js";import ne from"./PersonDetailContent-BjbM7UZK.js";import{E as R}from"./ExportButton-BQEjSXpZ.js";import{L as E}from"./list-plus-DpSArsmV.js";import{S as le}from"./search-DYm-wMZU.js";import{E as de}from"./eye--jr37nyh.js";import{S as ce}from"./square-pen-vvSpg7l-.js";import{T as me}from"./trash-2-D0zHUyfY.js";import{c as pe}from"./createLucideIcon-tGOSRdoQ.js";import"./sidebar-DTvw3aXB.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-XCqKAzY-.js";import"./index-DkI8As0p.js";import"./floating-ui.react-dom-CH_KqBmZ.js";import"./x-BwVgvZTi.js";import"./tooltip-w_xHr43J.js";import"./nav-user-BI5LsarM.js";import"./avatar-uAJ5rm9d.js";import"./stringFormat-Dx_XIxG1.js";import"./file-text-F4iMt6p7.js";import"./users-round-CP9XJTu1.js";import"./heart-pulse-DPuDzfZz.js";import"./chevron-up-D85Lw7mi.js";import"./breadcrumb-DUDN2ulf.js";import"./chevron-right-CYSwUaqK.js";import"./check-BVd6L0zb.js";import"./ellipsis-fOBkrL-4.js";import"./index-Cxc8uHiV.js";import"./iconBase-D4DM0745.js";import"./index-2GrJY7_j.js";import"./index-CSUEvA4p.js";import"./file-output-Cg2GyC3o.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],xe=pe("file-up",ue);function ht({blotters:g,queryParams:a,incident_types:T}){const B=[{label:"Katarungang Pambarangay",showOnMobile:!1},{label:"Blotter Reports",showOnMobile:!0}];a=a||{};const i=X().props,p=(i==null?void 0:i.success)??null,u=(i==null?void 0:i.error)??null,M=se(),[y,O]=o.useState(a.name??""),[$,x]=o.useState(!1),[j,I]=o.useState(null),[A,v]=o.useState(!1),[w,_]=o.useState(null),F=e=>{e.preventDefault(),h("name",y)},L=async e=>{try{const s=await Q.get(`${M}/resident/showresident/${e}`);_(s.data.resident)}catch(s){console.error("Error fetching placeholders:",s)}v(!0)},h=(e,s)=>{s&&s.trim()!==""?a[e]=s:delete a[e],a.page&&delete a.page,l.get(route("blotter_report.index",a))},z=(e,s)=>{if(s.key==="Enter")h(e,s.target.value);else return},d=[{key:"id",label:"ID"},{key:"type_of_incident",label:"Type of Incident"},{key:"latest_complainant",label:"Complainant(s)"},{key:"report_status",label:"Status"},{key:"incident_date",label:"Incident Date"},{key:"narrative_details",label:"Narrative Details"},{key:"actions_taken",label:"Actions Taken"},{key:"recommendations",label:"Recommendations"},{key:"recorded_by",label:"Recorded By"},{key:"actions",label:"Actions"}],[f,N]=o.useState(d.map(e=>e.key));o.useEffect(()=>{f.length===0&&N(d.map(e=>e.key))},[]);const[he,fe]=o.useState(!0),[be,ge]=o.useState(!1),b=Object.entries(a||{}).some(([e,s])=>["incident_type","incident_date"].includes(e)&&s&&s!=="");o.useEffect(()=>{b&&k(!0)},[b]);const[S,k]=o.useState(b),K={id:e=>e.id,type_of_incident:e=>t.jsx("span",{className:"font-medium text-gray-800",children:e.type_of_incident}),narrative_details:e=>t.jsx("span",{className:"line-clamp-2 text-gray-600",children:e.narrative_details}),recommendations:e=>t.jsx("span",{className:"line-clamp-2 text-gray-600",children:e.recommendations}),actions_taken:e=>e.actions_taken??"—",report_status:e=>{const s={pending:"bg-yellow-100 text-yellow-700",on_going:"bg-blue-100 text-blue-700",resolved:"bg-green-100 text-green-700",elevated:"bg-red-100 text-red-700"};return t.jsx("span",{className:`px-2 py-1 text-sm rounded-lg ${s[e.report_status]??"bg-gray-100 text-gray-700"}`,children:te[e.report_status]})},incident_date:e=>{if(!e.incident_date)return"—";const s=new Date(e.incident_date).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),r=new Date(e.incident_date).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0});return t.jsxs("div",{children:[t.jsx("div",{children:s}),t.jsxs("div",{className:"text-sm text-gray-500",children:["around ",r]})]})},recorded_by:e=>{var r,c,m,n;const s=e.recorded_by;return s?`${((r=s.resident)==null?void 0:r.firstname)??""} ${((c=s.resident)==null?void 0:c.middlename)??""} ${((m=s.resident)==null?void 0:m.lastname)??""} ${((n=s.resident)==null?void 0:n.suffix)??""}`??"—":"—"},latest_complainant:e=>{const s=e.complainants||[];return s.length===0?"—":s.map((r,c)=>{const m=r.resident?`${r.resident.firstname??""} ${r.resident.middlename??""} ${r.resident.lastname??""} ${r.resident.suffix??""}`.trim():r.name??"—";return t.jsxs("span",{children:[t.jsx("span",{className:"text-blue-600 hover:underline hover:cursor-pointer",onClick:()=>{var n;return((n=r.resident)==null?void 0:n.id)&&L(r.resident.id)},children:m}),c<s.length-1&&", "]},r.id)})},actions:e=>t.jsx(ee,{actions:[{label:"View",icon:t.jsx(de,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>l.visit(route("blotter_report.show",e.id))},{label:"Edit",icon:t.jsx(ce,{className:"w-4 h-4 text-green-500"}),onClick:()=>H(e.id)},{label:"Delete",icon:t.jsx(me,{className:"w-4 h-4 text-red-600"}),onClick:()=>U(e.id)},{label:"Elevate to Summon",icon:t.jsx(xe,{className:"w-4 h-4 text-red-900"}),onClick:()=>l.visit(route("summon.elevate",e.id))}]})},U=e=>{I(e),x(!0)},V=()=>{l.delete(route("blotter_report.destroy",j)),x(!1)},H=e=>{l.get(route("blotter_report.edit",e))};return o.useEffect(()=>{p&&C.success(p,{description:"Operation successful!",duration:3e3,closeButton:!0}),i.success=null},[p]),o.useEffect(()=>{u&&C.error(u,{description:"Operation failed!",duration:3e3,closeButton:!0}),i.error=null},[u]),t.jsxs(Z,{children:[t.jsx(G,{title:"Blotter Reports Dashboard"}),t.jsx(W,{breadcrumbs:B}),t.jsx(Y,{richColors:!0}),t.jsx("div",{className:"pt-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsxs("div",{className:"flex items-center gap-3 p-4 mb-6 bg-gray-50 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:t.jsx(E,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Blotter Reports"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Manage all blotter cases and incident reports within the barangay. Easily search, filter, export, and add new blotter records for accurate tracking and resolution."})]})]}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[t.jsx(oe,{allColumns:d,visibleColumns:f,setVisibleColumns:N,showFilters:S,toggleShowFilters:()=>k(e=>!e)}),t.jsx(R,{url:"report/export-blotter-reports-excel",queryParams:a,label:"Export Blotter Reports as XLSX"}),t.jsx(R,{url:"report/export-blotter-reports-pdf",queryParams:a,label:"Export Blotter Reports as PDF",type:"pdf",totalRecords:g.total})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:F,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(J,{type:"text",placeholder:"Search for Complainant",value:y,onChange:e=>O(e.target.value),onKeyDown:e=>z("name",e),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(D,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(le,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),t.jsx(P,{href:route("blotter_report.create"),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(D,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(E,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add a Blotter Report"})]})})]})]}),S&&t.jsx(re,{queryParams:a,searchFieldName:h,visibleFilters:["incident_type","incident_date"],showFilters:!0,types:T,clearRouteName:"blotter_report.index",clearRouteParams:{}}),t.jsx(q,{passedData:g,columnRenderers:K,allColumns:d,visibleColumns:f,showTotal:!0}),t.jsx(ie,{isOpen:A,onClose:()=>{v(!1),_(null)},title:"Resident Details",children:w&&t.jsx(ne,{person:w})}),t.jsx(ae,{isOpen:$,onClose:()=>{x(!1)},onConfirm:V,residentId:j})]})})})]})}export{ht as default};

import{K as H,r as a,j as t,L as Y,$ as Q,S as h,a as X}from"./app-BDFxb8TA.js";import{S as J,b as W}from"./AdminLayout-CM3_VNfS.js";import{B as k}from"./button-CpOsaw8_.js";import{I as Z}from"./input-jJkVEZh6.js";import P from"./BreadcrumbsHeader-BjgQDL1u.js";import{t as b,T as q}from"./index-BV4yT7DH.js";import ee from"./DynamicTable-CHhkyrvT.js";import te from"./ActionMenu-B1t3zEf2.js";import{R as se,c as oe}from"./constants-a7o6YRsm.js";import re from"./SidebarModal-BzXA3oBB.js";import ae from"./DynamicTableControls-Be3FEhX9.js";import ne from"./FillterToggle-D90xyrDX.js";import{u as ie}from"./useAppUrl-8JzvxBJd.js";import le from"./PersonDetailContent-BjbM7UZK.js";import ce from"./DeleteConfirmationModal-BmD4yp-x.js";import{E as de}from"./ExportButton-BQEjSXpZ.js";import{S as me}from"./search-DYm-wMZU.js";import{L as pe}from"./list-plus-DpSArsmV.js";import{E as ue}from"./eye--jr37nyh.js";import{S as xe}from"./square-pen-vvSpg7l-.js";import{T as fe}from"./trash-2-D0zHUyfY.js";import"./sidebar-DTvw3aXB.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-XCqKAzY-.js";import"./index-DkI8As0p.js";import"./floating-ui.react-dom-CH_KqBmZ.js";import"./x-BwVgvZTi.js";import"./createLucideIcon-tGOSRdoQ.js";import"./tooltip-w_xHr43J.js";import"./nav-user-BI5LsarM.js";import"./avatar-uAJ5rm9d.js";import"./dropdown-menu-enabQI5J.js";import"./check-BVd6L0zb.js";import"./chevron-right-CYSwUaqK.js";import"./stringFormat-Dx_XIxG1.js";import"./file-text-F4iMt6p7.js";import"./users-round-CP9XJTu1.js";import"./heart-pulse-DPuDzfZz.js";import"./chevron-up-D85Lw7mi.js";import"./breadcrumb-DUDN2ulf.js";import"./ellipsis-fOBkrL-4.js";import"./react-datepicker-bgVyIYaD.js";import"./index-Cxc8uHiV.js";import"./iconBase-D4DM0745.js";import"./index-2GrJY7_j.js";import"./index-CSUEvA4p.js";import"./file-output-Cg2GyC3o.js";function dt({vaccinations:C,puroks:_,queryParams:o}){const M=[{label:"Medical Information",showOnMobile:!1},{label:"Vaccinations",showOnMobile:!0}];o=o||{};const R=ie(),n=H().props,c=(n==null?void 0:n.success)??null,d=(n==null?void 0:n.error)??null,[T,m]=a.useState(!1),[g,O]=a.useState(null),[j,I]=a.useState(o.name??""),[F,p]=a.useState(!1),[v,w]=a.useState(null),V=e=>{if(!e)return"Unknown";const s=new Date(e),r=new Date;let l=r.getFullYear()-s.getFullYear();const i=r.getMonth()-s.getMonth();return(i<0||i===0&&r.getDate()<s.getDate())&&l--,l},A=e=>{e.preventDefault(),u("name",j)},u=(e,s)=>{s&&s.trim()!==""?o[e]=s:delete o[e],o.page&&delete o.page,h.get(route("vaccination.index",o))},L=(e,s)=>{if(s.key==="Enter")u(e,s.target.value);else return},x=[{key:"id",label:"ID"},{key:"name",label:"Resident Name"},{key:"age",label:"Age"},{key:"sex",label:"Sex"},{key:"vaccine",label:"Vaccine"},{key:"vaccination_date",label:"Vaccination Date"},{key:"purok_number",label:"Purok Number"},{key:"actions",label:"Actions"}],[N,B]=a.useState(x.map(e=>e.key)),f=Object.entries(o||{}).some(([e,s])=>["purok","sex","age_group","vaccine","vaccination_date"].includes(e)&&s&&s!=="");a.useEffect(()=>{f&&S(!0)},[f]);const[y,S]=a.useState(f),z={id:e=>e.id,name:e=>{const s=e.resident??{};return t.jsxs("span",{children:[s.firstname," ",s.middlename??""," ",s.lastname," ",s.suffix??""]})},sex:e=>{var i,D,E;const s=(i=e.resident)==null?void 0:i.sex,r=((D=se)==null?void 0:D[s])??s??"Unknown",l=((E=oe)==null?void 0:E[s])??"bg-gray-100 text-gray-800 px-2 py-1 rounded";return t.jsx("span",{className:`py-1 px-2 rounded-xl text-sm font-medium whitespace-nowrap ${l}`,children:r})},age:e=>{var r;const s=V((r=e.resident)==null?void 0:r.birthdate);return typeof s!="number"?"Unknown":t.jsxs("div",{className:"flex flex-col text-sm",children:[t.jsx("span",{className:"font-medium text-gray-800",children:s}),s>60&&t.jsx("span",{className:"text-xs text-rose-500 font-semibold",children:"Senior Citizen"})]})},vaccine:e=>e.vaccine??"—",vaccination_date:e=>e.vaccination_date?new Date(e.vaccination_date).toLocaleDateString():"—",purok_number:e=>{var s;return((s=e.resident)==null?void 0:s.purok_number)??"—"},actions:e=>t.jsx(te,{actions:[{label:"View",icon:t.jsx(ue,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>{var s;return G((s=e.resident)==null?void 0:s.id)}},{label:"Edit",icon:t.jsx(xe,{className:"w-4 h-4 text-green-500"}),onClick:()=>{var s,r;h.get(route("medical.edit",(r=(s=e==null?void 0:e.resident)==null?void 0:s.medical_information)==null?void 0:r.id))}},{label:"Delete",icon:t.jsx(fe,{className:"w-4 h-4 text-red-600"}),onClick:()=>$(e.id)}]})},U=()=>{p(!1),w(null)},$=e=>{O(e),m(!0)},K=()=>{h.delete(route("vaccination.destroy",g),{onError:e=>{console.error("Validation Errors:",e);const s=Object.values(e).join("<br />");b.error("Validation Error",{description:t.jsx("span",{dangerouslySetInnerHTML:{__html:s}}),duration:3e3,closeButton:!0})}}),m(!1)},G=async e=>{try{const s=await X.get(`${R}/resident/showresident/${e}`);w(s.data.resident)}catch(s){console.error("Error fetching placeholders:",s)}p(!0)};return a.useEffect(()=>{c&&(U(),b.success(c,{description:"Operation successful!",duration:3e3,closeButton:!0})),n.success=null},[c]),a.useEffect(()=>{d&&b.error(d,{description:"Operation failed!",duration:3e3,closeButton:!0}),n.error=null},[d]),t.jsxs(J,{children:[t.jsx(Y,{title:"Medical Information"}),t.jsxs("div",{children:[t.jsx(q,{richColors:!0}),t.jsx(P,{breadcrumbs:M}),t.jsx("div",{className:"p-2 md:p-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:t.jsx(W,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Vaccination Records"}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Manage and track residents’"," ",t.jsx("span",{className:"font-medium",children:"vaccination information"}),". Use the tools below to search, filter, or export records for immunization programs and services."]})]})]})}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[t.jsx(ae,{allColumns:x,visibleColumns:N,setVisibleColumns:B,showFilters:y,toggleShowFilters:()=>S(e=>!e)}),t.jsx(de,{url:"report/export-vaccination-pdf",queryParams:o,label:"Export Medical Condition Records as PDF",type:"pdf"})]}),t.jsx("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:t.jsxs("form",{onSubmit:A,className:"flex w-[380px] max-w-lg items-center space-x-1",children:[t.jsx(Z,{type:"text",placeholder:"Search Vaccine or Resident Name",value:j,onChange:e=>I(e.target.value),onKeyDown:e=>L("name",e.target.value),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(k,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(me,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]}),t.jsx("div",{className:"relative group z-50",children:t.jsxs(Q,{href:route("medical.create"),children:[t.jsx(k,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",type:"button",children:t.jsx(pe,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Medical Information"})]})})]})})]}),y&&t.jsx(ne,{queryParams:o,searchFieldName:u,visibleFilters:["purok","sex","age_group","vaccine","vaccination_date"],puroks:_,showFilters:!0,clearRouteName:"vaccination.index",clearRouteParams:{}}),t.jsx(ee,{passedData:C,allColumns:x,columnRenderers:z,queryParams:o,visibleColumns:N,showTotal:!0})]})})}),t.jsx(re,{isOpen:F,onClose:()=>p(!1),title:"Resident Details",children:v&&t.jsx(le,{person:v})}),t.jsx(ce,{isOpen:T,onClose:()=>{m(!1)},onConfirm:K,residentId:g})]})]})}export{dt as default};

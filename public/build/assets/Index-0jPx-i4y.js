import{K as V,r as a,j as e,L as G,$ as J,S as m,a as Q}from"./app-FQbzxGIw.js";import{S as P,F as W}from"./AdminLayout-D681-fmM.js";import{B as C}from"./button-9tywdtpe.js";import{I as Y}from"./input-BxejiG4V.js";import Z from"./BreadcrumbsHeader-BKQz8BHC.js";import{t as E,T as q}from"./index-CMTh6Y7Z.js";import"./table-CShSeIaY.js";import"./dropdown-menu-Mj4r6j7K.js";import ee from"./DynamicTable-BMSA2BaJ.js";import te from"./ActionMenu-CzwL-S4C.js";import{D as se,G as re,J as ae,K as ne}from"./constants-0uClA9D3.js";import{F as ie}from"./FillterToggle-C5Vn0ru6.js";import"./label-OHC_657r.js";import{u as oe}from"./useAppUrl-zATTBKeL.js";import le from"./DynamicTableControls-Dp8-Etap.js";import de from"./DeleteConfirmationModal-B0Xpw4Vn.js";import me from"./SidebarModal-DD4dEoye.js";import ce from"./PersonDetailContent-Bnjnk2Nd.js";import{E as pe}from"./ExportButton-tGc-eDMS.js";import{S as ue}from"./search-BMvlfdsT.js";import{L as xe}from"./list-plus-Dr4Qo9k_.js";import{E as fe}from"./eye-CGiTKL0k.js";import{S as he}from"./square-pen-BPpyNhve.js";import{T as be}from"./trash-2-DbTjliIz.js";import"./sidebar-kMsPs0kt.js";import"./index-D9GFQlD6.js";import"./index-BvtReL5S.js";import"./floating-ui.react-dom-Bv5Tn9NB.js";import"./x-SzE7BJuj.js";import"./createLucideIcon-CbmRPBK-.js";import"./skeleton-C5JXX0Vb.js";import"./tooltip-D5qIOJrT.js";import"./nav-user-NQ1-22E_.js";import"./avatar-B4QdFqbk.js";import"./users-round-fHMLq3qJ.js";import"./chevron-up-D1MoY1rl.js";import"./clsx-B-dksMZM.js";import"./breadcrumb-CZJEnQm8.js";import"./chevron-right-KG4eDgaU.js";import"./check-KP9WahT6.js";import"./ellipsis-CzsbrfyR.js";import"./iconBase-C4pIma2P.js";import"./index-DPWqtkCr.js";import"./index-BDSYX5a9.js";import"./file-output--5Kcqojd.js";function ut({summons:$,queryParams:n,incident_types:O}){const R=[{label:"Katarungang Pambarangay",showOnMobile:!1},{label:"Summons",showOnMobile:!0}];n=n||{};const i=V().props,p=(i==null?void 0:i.success)??null,u=(i==null?void 0:i.error)??null,A=oe(),[S,M]=a.useState(n.name??""),[I,x]=a.useState(!1),[y,F]=a.useState(null),[L,_]=a.useState(!1),[w,N]=a.useState(null),B=t=>{t.preventDefault(),f("name",S)},v=async t=>{try{const s=await Q.get(`${A}/resident/showresident/${t}`);N(s.data.resident)}catch(s){console.error("Error fetching placeholders:",s)}_(!0)},f=(t,s)=>{s&&s.trim()!==""?n[t]=s:delete n[t],n.page&&delete n.page,m.get(route("summon.index",n))},U=(t,s)=>{if(s.key==="Enter")f(t,s.target.value);else return},c=[{key:"id",label:"ID"},{key:"type_of_incident",label:"Type of Incident"},{key:"complainants",label:"Complainant(s)"},{key:"respondents",label:"Respondent(s)"},{key:"status",label:"Summon Status"},{key:"incident_date",label:"Incident Date"},{key:"hearing_info",label:"Hearing Details"},{key:"remarks",label:"Remarks"},{key:"issued_by",label:"Issued By"},{key:"actions",label:"Actions"}],[h,k]=a.useState(c.map(t=>t.key));a.useEffect(()=>{h.length===0&&k(c.map(t=>t.key))},[]);const[ge,je]=a.useState(!0),[Se,ye]=a.useState(!1),b=Object.entries(n||{}).some(([t,s])=>["incident_type","incident_date","summon_status","hearing_number","hearing_status"].includes(t)&&s&&s!=="");a.useEffect(()=>{b&&D(!0)},[b]);const[T,D]=a.useState(b),K={id:t=>t.id,type_of_incident:t=>{var s;return e.jsx("span",{className:"font-medium text-blue-600 hover:underline hover:cursor-pointer  text-wrap",onClick:()=>m.visit(route("blotter_report.show",t.blotter.id)),children:((s=t.blotter)==null?void 0:s.type_of_incident)??"—"})},complainants:t=>{var l,o;const s=((o=(l=t.blotter)==null?void 0:l.participants)==null?void 0:o.filter(r=>r.role_type==="complainant"))||[];return s.length===0?"—":e.jsx("div",{className:"flex flex-wrap gap-x-1 text-sm",children:s.map((r,g)=>{const j=r.resident?`${r.resident.firstname??""} ${r.resident.middlename??""} ${r.resident.lastname??""} ${r.resident.suffix??""}`.trim():r.name??r.display_name??"—";return e.jsxs("span",{className:"text-blue-600 hover:underline hover:cursor-pointer",onClick:()=>{var d;return v((d=r.resident)==null?void 0:d.id)},children:[j,g<s.length-1&&","]},r.id)})})},respondents:t=>{var l,o;const s=((o=(l=t.blotter)==null?void 0:l.participants)==null?void 0:o.filter(r=>r.role_type==="respondent"))||[];return s.length===0?"—":e.jsx("div",{className:"flex flex-wrap gap-x-1 text-sm",children:s.map((r,g)=>{const j=r.resident?`${r.resident.firstname??""} ${r.resident.middlename??""} ${r.resident.lastname??""} ${r.resident.suffix??""}`.trim():r.name??r.display_name??"—";return e.jsxs("span",{className:"text-red-600 hover:underline hover:cursor-pointer",onClick:()=>{var d;return v((d=r.resident)==null?void 0:d.id)},children:[j,g<s.length-1&&","]},r.id)})})},status:t=>e.jsx("span",{className:`px-2 py-1 text-sm rounded-lg ${ne[t.status]??"bg-gray-100 text-gray-700"}`,children:ae[t.status]}),incident_date:t=>{var s;return(s=t.blotter)!=null&&s.incident_date?new Date(t.blotter.incident_date).toLocaleDateString():"—"},hearing_info:t=>{const s=t.latest_take;return s?e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsxs("span",{className:"font-semibold text-gray-900",children:["Hearing ",s.session_number]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:s.hearing_date?new Date(s.hearing_date).toLocaleDateString():"No Date Set"}),e.jsx("span",{className:`text-xs ${re[s.session_status]}`,children:se[s.session_status]})]})]}):"—"},issued_by:t=>{var o;const s=(o=t.issued_by)==null?void 0:o.resident;if(!s)return"—";const l=`${s.firstname??""} ${s.middlename??""} ${s.lastname??""} ${s.suffix??""}`.trim();return e.jsx("span",{className:"text-wrap text-gray-600",children:l})},remarks:t=>e.jsx("span",{className:"line-clamp-2 text-gray-600 text-wrap",children:t.latest_take.session_remarks??"—"}),actions:t=>e.jsx(te,{actions:[{label:"View",icon:e.jsx(fe,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>m.visit(route("summon.show",t.blotter_id))},{label:"Edit",icon:e.jsx(he,{className:"w-4 h-4 text-green-500"}),onClick:()=>H(t.blotter_id)},{label:"Delete",icon:e.jsx(be,{className:"w-4 h-4 text-red-600"}),onClick:()=>z(t.id)}]})},z=t=>{F(t),x(!0)},X=()=>{m.delete(route("summon.destroy",y)),x(!1)},H=t=>{m.get(route("summon.elevate",t))};return a.useEffect(()=>{p&&E.success(p,{description:"Operation successful!",duration:3e3,closeButton:!0}),i.success=null},[p]),a.useEffect(()=>{u&&E.error(u,{description:"Operation failed!",duration:3e3,closeButton:!0}),i.error=null},[u]),e.jsxs(P,{children:[e.jsx(G,{title:"Blotter Reports Dashboard"}),e.jsx(Z,{breadcrumbs:R}),e.jsx(q,{richColors:!0}),e.jsx("div",{className:"pt-4",children:e.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 mb-6 bg-gray-50 rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(W,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Summon Records"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Track and manage summons issued in relation to blotter cases. Monitor hearing schedules, statuses, and ensure proper documentation for transparent case resolution."})]})]}),e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[e.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[e.jsx(le,{allColumns:c,visibleColumns:h,setVisibleColumns:k,showFilters:T,toggleShowFilters:()=>D(t=>!t)}),e.jsx(pe,{url:"report/export-summon-excel",queryParams:n,label:"Export Summon Records as XLSX"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[e.jsxs("form",{onSubmit:B,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[e.jsx(Y,{type:"text",placeholder:"Search for Complainant",value:S,onChange:t=>M(t.target.value),onKeyDown:t=>U("name",t),className:"w-full"}),e.jsxs("div",{className:"relative group z-50",children:[e.jsx(C,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:e.jsx(ue,{})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),e.jsx(J,{href:route("blotter_report.create"),children:e.jsxs("div",{className:"relative group z-50",children:[e.jsx(C,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:e.jsx(xe,{className:"w-4 h-4"})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Blotter Report"})]})})]})]}),T&&e.jsx(ie,{queryParams:n,searchFieldName:f,visibleFilters:["incident_type","incident_date","summon_status","hearing_number","hearing_status"],showFilters:!0,types:O,clearRouteName:"summon.index",clearRouteParams:{}}),e.jsx(ee,{passedData:$,columnRenderers:K,allColumns:c,visibleColumns:h,showTotal:!0}),e.jsx(me,{isOpen:L,onClose:()=>{_(!1),N(null)},title:"Resident Details",children:w&&e.jsx(ce,{person:w})}),e.jsx(de,{isOpen:I,onClose:()=>{x(!1)},onConfirm:X,residentId:y})]})})})]})}export{ut as default};

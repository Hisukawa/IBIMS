import{r as o,j as e,U as G}from"./app-OMiIBAVv.js";import{R as x}from"./ResponsiveContainer-CBRv-QyA.js";import{B as E,Y as C,a as f,L as j}from"./BarChart-CEgIJXP7.js";import{C as P}from"./CartesianGrid-DQDZrgSm.js";import{X as L}from"./XAxis-C5kNket2.js";import{T as u}from"./Tooltip-DOysCmSi.js";import{L as R}from"./Legend-DaLkMvIq.js";import{C as p}from"./CategoricalChart-BVh289CG.js";import{P as y,a as b}from"./PieChart-CrUQtwcK.js";import"./clsx-B-dksMZM.js";import"./Label-u1r-h5LA.js";import"./index-BLQZ4u8d.js";import"./string-CFFdVFMV.js";const v=["#2563EB","#60A5FA","#1E40AF"],N=["#2563EB","#60A5FA","#1E40AF"],O=["#1E3A8A","#1D4ED8","#2563EB","#3B82F6","#60A5FA"],K=["#1E3A8A","#1D4ED8","#2563EB","#3B82F6","#60A5FA","#93C5FD","#BFDBFE"],W=["#1E3A8A","#2563EB","#3B82F6","#60A5FA","#93C5FD","#BFDBFE","#DBEAFE"],_=[{label:"0-6m",min:0,max:.5},{label:"7m-2y",min:.5,max:2},{label:"3-5y",min:2,max:6},{label:"6-12y",min:6,max:13},{label:"13-17y",min:13,max:18},{label:"18-59y",min:18,max:60},{label:"60+y",min:60,max:1/0}],h=G.memo(({height:r})=>e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-6",children:[e.jsx("div",{className:"h-5 w-32 bg-gray-200 rounded mb-4 animate-pulse"}),e.jsx("div",{className:"w-full",style:{height:r},children:e.jsx("div",{className:"w-full h-full bg-gray-100 rounded animate-pulse"})})]})),U=r=>{if(!r)return null;const c=new Date(r);return isNaN(c.getTime())?null:(new Date-c)/315576e5},$=r=>{var c;return r===null?null:((c=_.find(m=>r>=m.min&&r<m.max))==null?void 0:c.label)||null},te=({residents:r,isLoading:c,welfareFilters:m=[]})=>{const n=o.useMemo(()=>Array.isArray(r)?r:(r==null?void 0:r.data)||[],[r]),{genderData:w,totalGender:F}=o.useMemo(()=>{const l=n.reduce((a,d)=>{let i=(d.gender||"Unknown").toLowerCase().trim();return i=i==="male"||i==="m"?"Male":i==="female"||i==="f"?"Female":"LGBTQ",a[i]=(a[i]||0)+1,a},{Male:0,Female:0,LGBTQ:0}),s=Object.entries(l).map(([a,d])=>({name:a,value:d})),t=s.reduce((a,d)=>a+d.value,0);return{genderData:s,totalGender:t}},[n]),{welfareData:S,totalWelfare:A}=o.useMemo(()=>{const l=n.reduce((i,g)=>(g.is_pwd?i.PWD++:g.is4ps?i.FourPs++:g.isSoloParent&&i.SoloParent++,i),{PWD:0,FourPs:0,SoloParent:0});let s=[];const t=["PWD","FourPs","SoloParent"],a=m.length>0?m:t;a.includes("PWD")&&s.push({name:"PWD",value:l.PWD}),a.includes("FourPs")&&s.push({name:"FourPs",value:l.FourPs}),a.includes("SoloParent")&&s.push({name:"SoloParent",value:l.SoloParent}),s=s.filter(i=>i.value>0||a.includes(i.name));const d=s.reduce((i,g)=>i+g.value,0);return{welfareData:s,totalWelfare:d}},[n,m]),M=o.useMemo(()=>{const l=n.reduce((s,t)=>{const a=t.purok_number||"Unknown";return s[a]=(s[a]||0)+1,s},{});return Object.entries(l).map(([s,t])=>({name:s,value:t}))},[n]),T=o.useMemo(()=>{const l=n.reduce((s,t)=>{const a=t.purok_number||"Unknown";return s[a]||(s[a]={registered:0,unregistered:0}),s[a][t.registered_voter===1?"registered":"unregistered"]+=1,s},{});return Object.entries(l).map(([s,t])=>({name:s,...t}))},[n]),k=o.useMemo(()=>{const l=n.reduce((s,t)=>{const a=(t.civil_status||"Unknown").toLowerCase().trim();return s[a]=(s[a]||0)+1,s},{});return Object.entries(l).map(([s,t])=>({name:s.charAt(0).toUpperCase()+s.slice(1),value:t}))},[n]),D=o.useMemo(()=>{const l=n.reduce((s,t)=>{const a=(t.employment_status||"unemployed").toLowerCase().trim(),i={student:"Student",employed:"Employed",self_employed:"Self-Employed",under_employed:"Under-Employed",unemployed:"Unemployed"}[a]||"Unemployed";return s[i]=(s[i]||0)+1,s},{});return Object.entries(l).map(([s,t])=>({name:s,value:t}))},[n]),B=o.useMemo(()=>n.reduce((s,t)=>{const a=$(U(t.birthdate));return a&&(s[a]=(s[a]||0)+1),s},{}),[n]),z=o.useMemo(()=>_.map(l=>({name:l.label,value:B[l.label]||0})),[B]);return c?e.jsx("div",{className:"pb-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-2",children:[e.jsx(h,{height:140}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-2",children:[e.jsx(h,{height:140}),e.jsx(h,{height:140})]})]}),e.jsxs("div",{className:"lg:col-span-2 flex flex-col gap-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsx(h,{height:80}),e.jsx(h,{height:80})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsx(h,{height:200}),e.jsx(h,{height:200})]})]})]})}):n.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 text-gray-500",children:[e.jsx("img",{src:"/images/chart_error.png",alt:"No records illustration",className:"h-40 w-auto mb-3"}),e.jsx("p",{className:"text-lg font-semibold",children:"No records found"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Try adjusting your filters or check back later."})]}):e.jsx("div",{className:"pb-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-2",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-700",children:"Population Demographics by Purok"}),e.jsx(x,{width:"100%",height:140,children:e.jsxs(E,{data:M,margin:{top:10,right:20,left:-20,bottom:5},children:[e.jsx(P,{strokeDasharray:"3 3",vertical:!1}),e.jsx(L,{dataKey:"name",axisLine:!1,tickLine:!1,dy:10,tick:{fontSize:13}}),e.jsx(C,{axisLine:!1,tickLine:!1,tick:{fontSize:10}}),e.jsx(u,{cursor:{fill:"rgba(239, 246, 255, 0.5)"},wrapperClassName:"rounded-lg shadow-lg"}),e.jsx(f,{dataKey:"value",barSize:35,radius:[10,10,0,0],fill:"#1E40AF",children:e.jsx(j,{dataKey:"value",position:"top",fill:"#6B7280",fontSize:12})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-700",children:"Registered Voter by Purok"}),e.jsx(x,{width:"100%",height:140,children:e.jsxs(E,{data:T,layout:"vertical",margin:{top:-10,right:20,left:-40,bottom:10},children:[e.jsx(P,{strokeDasharray:"3 3",horizontal:!1}),e.jsx(L,{type:"number",hide:!0}),e.jsx(C,{type:"category",dataKey:"name",width:60,axisLine:!1,tickLine:!1,tick:{fontSize:10}}),e.jsx(u,{wrapperClassName:"rounded-lg shadow-lg"}),e.jsx(R,{verticalAlign:"top",align:"left",wrapperStyle:{top:-20,left:0,fontSize:12}}),e.jsx(f,{dataKey:"registered",name:"Registered",fill:"#2563EB",stackId:"a",barSize:30,radius:[15,0,0,15],children:e.jsx(j,{dataKey:"registered",position:"inside",fill:"#fff",fontSize:12})}),e.jsx(f,{dataKey:"unregistered",name:"Unregistered",fill:"#60A5FA",stackId:"a",barSize:30,radius:[0,15,15,0],children:e.jsx(j,{dataKey:"unregistered",position:"inside",fill:"#fff",fontSize:12})})]})})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-700",children:"Age Distribution"}),e.jsx(x,{width:"100%",height:140,children:e.jsxs(E,{data:z,margin:{top:10,right:5,left:-25,bottom:5},children:[e.jsx(P,{strokeDasharray:"3 3",vertical:!1}),e.jsx(L,{dataKey:"name",axisLine:!1,tickLine:!1,fontSize:12,dy:10}),e.jsx(C,{axisLine:!1,tickLine:!1,fontSize:12}),e.jsx(u,{wrapperClassName:"rounded-lg shadow-lg"}),e.jsxs(f,{dataKey:"value",barSize:30,radius:[10,10,0,0],children:[z.map((l,s)=>e.jsx(p,{fill:K[s%K.length]},`age-cell-${l.name}`)),e.jsx(j,{dataKey:"value",position:"top",fill:"#6B7280",fontSize:12})]})]})})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 flex flex-col gap-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-4 h-44",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Gender"}),e.jsxs("div",{className:"flex items-center h-full",children:[e.jsx("div",{className:"w-2/5 h-full",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(y,{children:[e.jsx(b,{data:w,cx:"50%",cy:"50%",outerRadius:40,innerRadius:30,dataKey:"value",cornerRadius:5,children:w.map((l,s)=>e.jsx(p,{fill:v[s%v.length],stroke:"#FFFFFF",strokeWidth:2},`gender-cell-${l.name}`))}),e.jsx(u,{formatter:(l,s)=>[`${l}`,s],contentStyle:{fontSize:"12px",borderRadius:"8px"}}),e.jsx("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"middle",className:"text-2xl font-bold fill-gray-800",children:F})]})})}),e.jsx("div",{className:"w-3/5 flex flex-col justify-center gap-2 pl-4",children:w.map((l,s)=>e.jsxs("div",{className:"flex items-center text-sm w-full",children:[e.jsx("span",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:v[s%v.length]}}),e.jsx("span",{className:"font-medium text-gray-700",children:l.name}),e.jsx("span",{className:"ml-auto text-gray-500",children:`${F>0?(l.value/F*100).toFixed(0):0}%`})]},`gender-legend-${l.name}`))})]})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-4 h-44",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Social Welfare"}),e.jsxs("div",{className:"flex items-center h-full",children:[e.jsx("div",{className:"w-2/5 h-full",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(y,{children:[e.jsx(b,{data:S,cx:"50%",cy:"50%",outerRadius:40,innerRadius:30,dataKey:"value",cornerRadius:5,children:S.map((l,s)=>e.jsx(p,{fill:N[s%N.length],stroke:"#FFFFFF",strokeWidth:2},`welfare-cell-${l.name}`))}),e.jsx(u,{formatter:(l,s)=>[`${l}`,s],contentStyle:{fontSize:"12px",borderRadius:"8px"}}),e.jsx("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"middle",className:"text-2xl font-bold fill-gray-800",children:A})]})})}),e.jsx("div",{className:"w-3/5 flex flex-col justify-center gap-2 pl-4",children:S.map((l,s)=>e.jsxs("div",{className:"flex items-center text-sm w-full",children:[e.jsx("span",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:N[s%N.length]}}),e.jsx("span",{className:"font-medium text-gray-700",children:l.name==="FourPs"?"4Ps":l.name}),e.jsx("span",{className:"ml-auto text-gray-500",children:`${A>0?(l.value/A*100).toFixed(0):0}%`})]},`welfare-legend-${l.name}`))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Civil Status"}),e.jsx(x,{width:"100%",height:220,children:e.jsxs(y,{children:[e.jsx(b,{data:k,cx:"50%",cy:"50%",outerRadius:70,innerRadius:40,dataKey:"value",children:k.map((l,s)=>e.jsx(p,{fill:W[s%W.length],stroke:"#FFFFFF",strokeWidth:2},`civil-cell-${l.name}`))}),e.jsx("text",{x:"50%",y:"40%",textAnchor:"middle",dominantBaseline:"middle",className:"text-2xl font-semibold fill-gray-700",children:k.reduce((l,s)=>l+s.value,0)}),e.jsx(u,{wrapperClassName:"rounded-lg shadow-lg"}),e.jsx(R,{iconType:"circle",iconSize:8,verticalAlign:"bottom",align:"center",wrapperStyle:{fontSize:"11px",paddingTop:"20px"}})]})})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Employment"}),e.jsx(x,{width:"100%",height:220,children:e.jsxs(y,{children:[e.jsx(b,{data:D,cx:"50%",cy:"50%",outerRadius:70,innerRadius:40,dataKey:"value",children:D.map((l,s)=>e.jsx(p,{fill:O[s%O.length],stroke:"#FFFFFF",strokeWidth:2},`employment-cell-${l.name}`))}),e.jsx("text",{x:"50%",y:"35%",textAnchor:"middle",dominantBaseline:"middle",className:"text-2xl font-semibold fill-gray-700",children:D.reduce((l,s)=>l+s.value,0)}),e.jsx(u,{wrapperClassName:"rounded-lg shadow-lg"}),e.jsx(R,{iconType:"circle",iconSize:8,verticalAlign:"bottom",align:"center",wrapperStyle:{fontSize:"11px",paddingTop:"20px"}})]})})]})]})]})]})})};export{te as default};

import{K as H,r as o,j as t,L as Y,$ as Q,S as f,a as W}from"./app-CYjubXcb.js";import{S as X,A as J}from"./AdminLayout--l-KZkcj.js";import{B as E}from"./button-sAotJoLm.js";import{I as Z}from"./input-UUEsUVC-.js";import P from"./BreadcrumbsHeader-BMzwqHmW.js";import{t as h,T as q}from"./index-Nkktqz5-.js";import ee from"./DynamicTable-DWTApLnk.js";import te from"./ActionMenu-B_-Eu6N4.js";import{R as se,b as ie}from"./constants-ByT4XGLj.js";import re from"./SidebarModal-BuTt6FzB.js";import oe from"./DynamicTableControls-BL0GbH24.js";import ae from"./FillterToggle-Bhm3ivWm.js";import{u as le}from"./useAppUrl-xCAiQ2Jy.js";import ne from"./PersonDetailContent-OU9ZsHku.js";import de from"./DeleteConfirmationModal-Co_8faR_.js";import{E as ce}from"./ExportButton-hJdkOroF.js";import{S as me}from"./search-BsH1nDuG.js";import{L as pe}from"./list-plus-CDJZApsx.js";import{E as ue}from"./eye-BFrdEdow.js";import{S as xe}from"./square-pen-y7QA14jG.js";import{T as be}from"./trash-2-BngOGgpP.js";import"./sidebar-BpvzJ5lK.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-C4Ke6hAv.js";import"./index-BwJ3XWkn.js";import"./floating-ui.react-dom-CBCZEv9t.js";import"./x-Cy6oWex1.js";import"./createLucideIcon-zwhh55E_.js";import"./tooltip-B8uc5q9P.js";import"./nav-user-DbQr6VCO.js";import"./avatar-BU9wZrTi.js";import"./dropdown-menu-Bz-zuVkL.js";import"./check-CgFUlvlz.js";import"./chevron-right-gBhi1ZR3.js";import"./stringFormat-Dx_XIxG1.js";import"./file-text-CJU5yhcd.js";import"./users-round-BtfjTBvk.js";import"./heart-pulse-DDzDHS3k.js";import"./chevron-up-B8LDdSpG.js";import"./breadcrumb-1G_dbrY1.js";import"./ellipsis-8Ze91mV3.js";import"./react-datepicker-CFOBpUWW.js";import"./index-D6xKqXSa.js";import"./iconBase-DN4slCyb.js";import"./index-CX3KNb5l.js";import"./index-BUkF7Sg_.js";import"./file-output-ptGiw6Wg.js";function ct({disabilities:k,puroks:C,queryParams:r}){const R=[{label:"Medical Information",showOnMobile:!1},{label:"Disabilities",showOnMobile:!0}];r=r||{};const M=le(),a=H().props,d=(a==null?void 0:a.success)??null,c=(a==null?void 0:a.error)??null,[T,m]=o.useState(!1),[g,I]=o.useState(null),[j,O]=o.useState(r.name??""),[A,p]=o.useState(!1),[y,N]=o.useState(null),F=e=>{if(!e)return"Unknown";const s=new Date(e),i=new Date;let n=i.getFullYear()-s.getFullYear();const l=i.getMonth()-s.getMonth();return(l<0||l===0&&i.getDate()<s.getDate())&&n--,n},L=e=>{e.preventDefault(),u("name",j)},u=(e,s)=>{s&&s.trim()!==""?r[e]=s:delete r[e],r.page&&delete r.page,f.get(route("disability.index",r))},B=(e,s)=>{if(s.key==="Enter")u(e,s.target.value);else return},x=[{key:"id",label:"ID"},{key:"name",label:"Resident Name"},{key:"age",label:"Age"},{key:"sex",label:"Sex"},{key:"type",label:"Disability Type"},{key:"pwd_id_number",label:"PWD ID Number"},{key:"purok_number",label:"Purok Number"},{key:"actions",label:"Actions"}],[w,U]=o.useState(x.map(e=>e.key)),b=Object.entries(r||{}).some(([e,s])=>["purok","sex","age_group","disability_type"].includes(e)&&s&&s!=="");o.useEffect(()=>{b&&D(!0)},[b]);const[v,D]=o.useState(b),z={id:e=>e.id,name:e=>{const s=e.resident??{};return t.jsxs("span",{children:[s.firstname," ",s.middlename??""," ",s.lastname," ",s.suffix??""]})},sex:e=>{var l,S,_;const s=(l=e.resident)==null?void 0:l.sex,i=((S=se)==null?void 0:S[s])??s??"Unknown",n=((_=ie)==null?void 0:_[s])??"bg-gray-100 text-gray-800 px-2 py-1 rounded";return t.jsx("span",{className:`py-1 px-2 rounded-xl text-sm font-medium whitespace-nowrap ${n}`,children:i})},age:e=>{var i;const s=F((i=e.resident)==null?void 0:i.birthdate);return typeof s!="number"?"Unknown":t.jsxs("div",{className:"flex flex-col text-sm",children:[t.jsx("span",{className:"font-medium text-gray-800",children:s}),s>60&&t.jsx("span",{className:"text-xs text-rose-500 font-semibold",children:"Senior Citizen"})]})},type:e=>e.disability_type??"—",pwd_id_number:e=>{var s,i,n,l;return(i=(s=e==null?void 0:e.resident)==null?void 0:s.medical_information)!=null&&i.pwd_id_number?(l=(n=e==null?void 0:e.resident)==null?void 0:n.medical_information)==null?void 0:l.pwd_id_number:"—"},purok_number:e=>{var s;return((s=e.resident)==null?void 0:s.purok_number)??"—"},actions:e=>t.jsx(te,{actions:[{label:"View",icon:t.jsx(ue,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>{var s;return G((s=e.resident)==null?void 0:s.id)}},{label:"Edit",icon:t.jsx(xe,{className:"w-4 h-4 text-green-500"}),onClick:()=>{var s,i;f.get(route("medical.edit",(i=(s=e==null?void 0:e.resident)==null?void 0:s.medical_information)==null?void 0:i.id))}},{label:"Delete",icon:t.jsx(be,{className:"w-4 h-4 text-red-600"}),onClick:()=>V(e.id)}]})},K=()=>{p(!1),N(null)},V=e=>{I(e),m(!0)},$=()=>{f.delete(route("disability.destroy",g),{onError:e=>{console.error("Validation Errors:",e);const s=Object.values(e).join("<br />");h.error("Validation Error",{description:t.jsx("span",{dangerouslySetInnerHTML:{__html:s}}),duration:3e3,closeButton:!0})}}),m(!1)},G=async e=>{try{const s=await W.get(`${M}/resident/showresident/${e}`);N(s.data.resident)}catch(s){console.error("Error fetching placeholders:",s)}p(!0)};return o.useEffect(()=>{d&&(K(),h.success(d,{description:"Operation successful!",duration:3e3,closeButton:!0})),a.success=null},[d]),o.useEffect(()=>{c&&h.error(c,{description:"Operation failed!",duration:3e3,closeButton:!0}),a.error=null},[c]),t.jsxs(X,{children:[t.jsx(Y,{title:"Medical Information"}),t.jsxs("div",{children:[t.jsx(q,{richColors:!0}),t.jsx(P,{breadcrumbs:R}),t.jsx("div",{className:"p-2 md:p-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-indigo-50 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-2 bg-indigo-100 rounded-full",children:t.jsx(J,{className:"w-6 h-6 text-indigo-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Disability Records"}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Keep track of residents with"," ",t.jsx("span",{className:"font-medium",children:"disabilities"})," ","for accurate profiling and support programs. Use the tools below to search, filter, and export records."]})]})]})}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[t.jsx(oe,{allColumns:x,visibleColumns:w,setVisibleColumns:U,showFilters:v,toggleShowFilters:()=>D(e=>!e)}),t.jsx(ce,{url:"report/export-disabilities-pdf",queryParams:r,label:"Export Medical Condition Records as PDF",type:"pdf"})]}),t.jsx("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:t.jsxs("form",{onSubmit:L,className:"flex w-[380px] max-w-lg items-center space-x-1",children:[t.jsx(Z,{type:"text",placeholder:"Search Disability or Resident Name",value:j,onChange:e=>O(e.target.value),onKeyDown:e=>B("name",e.target.value),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(E,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(me,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]}),t.jsx("div",{className:"relative group z-50",children:t.jsxs(Q,{href:route("medical.create"),children:[t.jsx(E,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",type:"button",children:t.jsx(pe,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Medical Information"})]})})]})})]}),v&&t.jsx(ae,{queryParams:r,searchFieldName:u,visibleFilters:["purok","sex","age_group","disability_type"],puroks:C,showFilters:!0,clearRouteName:"disability.index",clearRouteParams:{}}),t.jsx(ee,{passedData:k,allColumns:x,columnRenderers:z,queryParams:r,visibleColumns:w,showTotal:!0})]})})}),t.jsx(re,{isOpen:A,onClose:()=>p(!1),title:"Resident Details",children:y&&t.jsx(ne,{person:y})}),t.jsx(de,{isOpen:T,onClose:()=>{m(!1)},onConfirm:$,residentId:g})]})]})}export{ct as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AdminLayout-DF3T9r93.js","assets/app-DWLvIQdF.js","assets/app-BlIeE0dN.css","assets/sidebar-B55M1Lhe.js","assets/button-D5oOHpih.js","assets/clsx-B-dksMZM.js","assets/utils-CkmPJWYF.js","assets/input-Bjq-UOVg.js","assets/index-C7xi9LN0.js","assets/index-DaxHkuH7.js","assets/floating-ui.react-dom-TXoiB1Cy.js","assets/x-Dj4h3Hl7.js","assets/createLucideIcon-COg8xDid.js","assets/skeleton-DxhMNfTQ.js","assets/tooltip-DGgHmMGp.js","assets/nav-user-ifqrtdkH.js","assets/avatar-xvo1q8ho.js","assets/dropdown-menu-301tgmQC.js","assets/check-DAMLPx8H.js","assets/chevron-right-B7veGfa5.js","assets/useAppUrl-DygNqr49.js","assets/users-round-DfUg6NaG.js","assets/heart-pulse-DBmhNY90.js","assets/chevron-up-DDEZVR48.js","assets/SidebarModal-vxJbyoHl.js","assets/PersonDetailContent-Da4-28D9.js","assets/iconBase-BwLSqiDZ.js","assets/index-BHp23fmt.js","assets/constants-BC8DDBPg.js","assets/index-CidfdT4c.js","assets/BreadcrumbsHeader-Cn59CTpR.js","assets/breadcrumb-Tr7bH4sQ.js","assets/DynamicTable-D6nhkc6_.js","assets/ActionMenu-BTp0V9kb.js","assets/ellipsis-BLBb_BVq.js","assets/FillterToggle-C8sWYfDm.js","assets/FillterToggle-DdjxYr1F.css","assets/DynamicTableControls-Zyjm1i4x.js","assets/DeleteConfirmationModal-BeH75Yd3.js","assets/index-DiQ2ABd4.js","assets/ResidentCharts-Dq_Op3-s.js","assets/ResponsiveContainer-w5L57ZQR.js","assets/CategoricalChart-Dx3mi8Pn.js","assets/string-CFFdVFMV.js","assets/BarChart-B748jO5v.js","assets/Label-BnPLxmAe.js","assets/CartesianGrid-D2kaIRCy.js","assets/XAxis-BxsDce4B.js","assets/Tooltip-hAads9gx.js","assets/Legend-B5Da1nZ3.js","assets/PieChart-DzY8VNBT.js"])))=>i.map(i=>d[i]);
import{r as s,K as Z,S as f,j as t,L as J,$ as L,a as O,_ as i}from"./app-DWLvIQdF.js";import{B as b}from"./button-D5oOHpih.js";import{I as ee}from"./input-Bjq-UOVg.js";import{t as n,T as te}from"./index-DiQ2ABd4.js";import{m as se,Z as ae,o as re,p as oe,R as ie,b as le}from"./constants-BC8DDBPg.js";import{u as ne}from"./useAppUrl-DygNqr49.js";import{u as ce}from"./useQuery-C7hK2GdS.js";import{E as de}from"./ExportButton-BsOx-3gy.js";import{E as ue}from"./eye-dW3Ce4Eu.js";import{S as me}from"./square-pen-Cxeeoy9N.js";import{T as pe}from"./trash-2-DlJ2Uvw3.js";import{N as xe}from"./network-B9_qBKdy.js";import{S as he}from"./search-G9nvaKgi.js";import{H as _e}from"./house-plus-zjB19fFt.js";import{c as fe}from"./createLucideIcon-COg8xDid.js";import"./clsx-B-dksMZM.js";import"./utils-CkmPJWYF.js";import"./index-DaxHkuH7.js";import"./file-output-B2RE3o7w.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M22 19h-6",key:"vcuq98"}]],ge=fe("user-round-plus",be),ye=s.lazy(()=>i(()=>import("./AdminLayout-DF3T9r93.js").then(l=>l.d),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),je=s.lazy(()=>i(()=>import("./SidebarModal-vxJbyoHl.js"),__vite__mapDeps([24,1,2,11,12]))),ve=s.lazy(()=>i(()=>import("./PersonDetailContent-Da4-28D9.js"),__vite__mapDeps([25,1,2,26,27,28,29,22,12]))),Ee=s.lazy(()=>i(()=>import("./BreadcrumbsHeader-Cn59CTpR.js"),__vite__mapDeps([30,1,2,31,4,5,6,19,12,3,7,8,9,10,11,13,14]))),we=s.lazy(()=>i(()=>import("./DynamicTable-D6nhkc6_.js"),__vite__mapDeps([32,1,2,12]))),Se=s.lazy(()=>i(()=>import("./ActionMenu-BTp0V9kb.js"),__vite__mapDeps([33,1,2,4,5,6,17,8,9,10,18,12,19,14,34]))),Ne=s.lazy(()=>i(()=>import("./FillterToggle-C8sWYfDm.js").then(l=>l.a),__vite__mapDeps([35,1,2,9,4,5,6,10,23,12,18,28,36]))),Te=s.lazy(()=>i(()=>import("./DynamicTableControls-Zyjm1i4x.js"),__vite__mapDeps([37,1,2,17,8,9,10,6,5,18,12,19,4]))),Re=s.lazy(()=>i(()=>import("./DeleteConfirmationModal-BeH75Yd3.js"),__vite__mapDeps([38,1,2,39,9,11,12]))),ke=s.lazy(()=>i(()=>import("./ResidentCharts-Dq_Op3-s.js"),__vite__mapDeps([40,1,2,41,5,42,43,44,45,46,47,48,9,49,50]))),De=[{label:"Residents Information",showOnMobile:!1},{label:"Information Table",showOnMobile:!0}],g=[{key:"resident_id",label:"ID"},{key:"resident_picture",label:"Resident Image"},{key:"name",label:"Name"},{key:"sex",label:"Sex"},{key:"age",label:"Age"},{key:"civil_status",label:"Civil Status"},{key:"employment_status",label:"Employment"},{key:"occupation",label:"Occupation"},{key:"ethnicity",label:"Ethnicity"},{key:"registered_voter",label:"Registered Voter"},{key:"contact_number",label:"Contact Number"},{key:"email",label:"Email"},{key:"purok_number",label:"Purok"},{key:"actions",label:"Actions"}];function We({residents:l,queryParams:m=null,puroks:C,ethnicities:P}){const r=s.useMemo(()=>m||{},[m]),{props:A}=Z(),{success:p,error:x}=A,M=ne();s.useEffect(()=>{p&&n.success(p,{description:"Operation successful!",duration:3e3,closeButton:!0}),x&&n.error(x,{description:"Operation failed!",duration:3e3,closeButton:!0})},[p,x]);const[y,F]=s.useState(r.name??""),z=s.useMemo(()=>{const e=[];return r.pwd==="1"&&e.push("PWD"),r.fourps==="1"&&e.push("FourPs"),r.solo_parent==="1"&&e.push("SoloParent"),e},[r.pwd,r.fourps,r.solo_parent]),{data:V,isLoading:$,isError:Ie}=ce({queryKey:["residents-chart",r],queryFn:async({signal:e})=>{const{data:a}=await O.get(`${M}/resident/chartdata`,{params:m,signal:e});return a.residents},enabled:!0,placeholderData:e=>e,staleTime:5*60*1e3,cacheTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1}),h=s.useMemo(()=>(e,a)=>{let o={...r};a&&a.trim()!==""&&a!=="0"?o[e]=a:delete o[e],delete o.page,f.get(route("resident.index",o),{preserveState:!0,replace:!0})},[r]),U=e=>{e.preventDefault(),h("name",y)},B=(e,a)=>{a.key==="Enter"&&h(e,a.target.value)},j=s.useMemo(()=>e=>{if(!e)return"Unknown";const a=new Date(e),o=new Date;let u=o.getFullYear()-a.getFullYear();const I=o.getMonth()-a.getMonth();return(I<0||I===0&&o.getDate()<a.getDate())&&u--,u},[]),v=e=>{f.get(route("resident.edit",e))},[q,E]=s.useState(!1),[w,K]=s.useState(null),S=async e=>{try{const a=await O.get(route("resident.showresident",e));K(a.data.resident)}catch(a){console.error("Error fetching resident details:",a),n.error("Failed to load resident details.",{description:a.message})}E(!0)},[N,G]=s.useState(g.map(e=>e.key)),_=s.useMemo(()=>Object.entries(r).some(([e,a])=>["purok","sex","gender","age_group","estatus","ethnic","voter_status","cstatus","pwd","fourps","solo_parent"].includes(e)&&a&&a!==""&&a!=="0"),[r]),[T,R]=s.useState(_);s.useEffect(()=>{R(_)},[_]);const[H,c]=s.useState(!1),[d,k]=s.useState(null),D=e=>{k(e),c(!0)},Q=s.useMemo(()=>()=>{d&&f.delete(route("resident.destroy",d),{onSuccess:()=>{n.success("Resident deleted successfully!"),c(!1),k(null)},onError:e=>{n.error("Failed to delete resident.",{description:e.message}),c(!1)}})},[d]),X=s.useMemo(()=>({resident_id:e=>e.id,resident_picture:e=>t.jsx("img",{src:e.resident_picture?`/storage/${e.resident_picture}`:"/images/default-avatar.jpg",onError:a=>{a.target.onerror=null,a.target.src="/images/default-avatar.jpg"},alt:"Resident",className:"w-16 h-16 min-w-16 min-h-16 object-cover rounded-full border",loading:"lazy"}),name:e=>t.jsx("div",{className:"text-sm break-words whitespace-normal leading-snug",children:`${e.firstname} ${e.middlename?e.middlename+" ":""}${e.lastname??""} ${e.suffix?e.suffix:""}`}),sex:e=>{const a=e.sex,o=ie[a]??"Unknown",u=le[a]??"bg-gray-300";return t.jsx("span",{className:`py-1 px-2 rounded-xl text-sm font-medium whitespace-nowrap ${u}`,children:o})},age:e=>{const a=j(e.birthdate);return typeof a!="number"?"Unknown":t.jsxs("div",{className:"flex flex-col text-sm",children:[t.jsx("span",{className:"font-medium text-gray-800",children:a}),a>60&&t.jsx("span",{className:"text-xs text-rose-500 font-semibold",children:"Senior Citizen"})]})},civil_status:e=>ae[e.civil_status],employment_status:e=>se[e.employment_status],occupation:e=>e.occupation?t.jsx("span",{className:"text-sm text-gray-700",children:e.occupation}):t.jsx("span",{className:"text-gray-400 text-[12px] italic",children:"No occupation available"}),ethnicity:e=>e.ethnicity,registered_voter:e=>t.jsx("span",{className:`${oe[e.registered_voter]} whitespace-nowrap`,children:re[e.registered_voter]}),contact_number:e=>t.jsx("span",{className:"whitespace-nowrap",children:e.contact_number}),purok_number:e=>e.purok_number,email:e=>e.email,actions:e=>t.jsx(Se,{actions:[{label:"View",icon:t.jsx(ue,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>S(e.id)},{label:"Edit",icon:t.jsx(me,{className:"w-4 h-4 text-green-500"}),onClick:()=>v(e.id)},{label:"Delete",icon:t.jsx(pe,{className:"w-4 h-4 text-red-600"}),onClick:()=>D(e.id)},{label:"Family Tree",icon:t.jsx(xe,{className:"w-4 h-4 text-blue-500"}),href:route("resident.familytree",e.id),tooltip:"See Family Tree"}]})}),[j,S,D,v]),[Y,W]=s.useState(r.all==="true");return s.useEffect(()=>{W(r.all==="true")},[r.all]),t.jsxs(s.Suspense,{fallback:t.jsx("div",{children:"Loading Page..."}),children:[" ",t.jsxs(ye,{children:[t.jsx(J,{title:"Resident"}),t.jsxs("div",{children:[t.jsx(te,{richColors:!0}),t.jsx(s.Suspense,{fallback:t.jsx("div",{children:"Loading Breadcrumbs..."}),children:t.jsx(Ee,{breadcrumbs:De})}),t.jsx("div",{className:"p-2 md:p-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-0",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsx(s.Suspense,{fallback:t.jsx("div",{children:"Loading Charts..."}),children:t.jsx(ke,{residents:V??[],isLoading:$,welfareFilters:z})}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[t.jsx(s.Suspense,{fallback:t.jsx("div",{children:"Loading Controls..."}),children:t.jsx(Te,{allColumns:g,visibleColumns:N,setVisibleColumns:G,showFilters:T,toggleShowFilters:()=>R(e=>!e)})}),t.jsx(de,{url:"report/export-residents-excel",queryParams:r})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:U,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(ee,{type:"text",placeholder:"Search",value:y,onChange:e=>F(e.target.value),onKeyDown:B,className:"ml-4"}),t.jsxs("div",{className:"relative group z-5",children:[t.jsx(b,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(he,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),t.jsx(L,{href:route("resident.create"),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(b,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(_e,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Household"})]})}),t.jsx(L,{href:route("resident.createresident"),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(b,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(ge,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Resident"})]})})]})]}),T&&t.jsx(s.Suspense,{fallback:t.jsx("div",{children:"Loading Filters..."}),children:t.jsx(Ne,{queryParams:r,searchFieldName:h,visibleFilters:["purok","sex","gender","age_group","estatus","ethnic","voter_status","cstatus","pwd","fourps","solo_parent"],showFilters:!0,puroks:C,clearRouteName:"resident.index",clearRouteParams:{},ethnicities:P})}),t.jsx(s.Suspense,{fallback:t.jsx("div",{children:"Loading Table..."}),children:t.jsx(we,{passedData:l,allColumns:g,columnRenderers:X,showAll:Y,visibleColumns:N,showTotal:!0})})]})})})]}),t.jsxs(s.Suspense,{fallback:null,children:[" ",t.jsx(je,{isOpen:q,onClose:()=>E(!1),title:"Resident Details",children:w&&t.jsx(ve,{person:w})}),t.jsx(Re,{isOpen:H,onClose:()=>c(!1),onConfirm:Q,residentId:d})]})]})]})}export{We as default};

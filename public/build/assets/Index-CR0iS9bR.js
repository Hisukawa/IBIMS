import{K as H,r as n,j as t,L as Q,$ as X,S as h,a as J}from"./app-DYAKcHNl.js";import{S as W,a as Z}from"./AdminLayout-Bi-pGIXA.js";import{B as C}from"./button-jar7PpFE.js";import{I as P}from"./input-CxeHRvhM.js";import q from"./BreadcrumbsHeader-CKnM-akv.js";import{t as b,T as ee}from"./index-BXPBQSyU.js";import te from"./DynamicTable-Bf7mtaHD.js";import se from"./ActionMenu-BHPpl9Ng.js";import{N as oe,O as E,R as re,b as ne}from"./constants-CqzG63r4.js";import ae from"./SidebarModal-DoEksQTx.js";import ie from"./DynamicTableControls-CrDmP0BC.js";import le from"./FillterToggle-CdqcdYDe.js";import{u as de}from"./useAppUrl-DkyKnUCU.js";import ce from"./PersonDetailContent-sFp-DEJW.js";import me from"./DeleteConfirmationModal-Bpm1W1P1.js";import{E as pe}from"./ExportButton-B89jBV1A.js";import{S as ue}from"./search-BOXoXOu7.js";import{L as xe}from"./list-plus-AGHRHozz.js";import{E as fe}from"./eye-BD8GiZXD.js";import{S as he}from"./square-pen-CvXrJSEC.js";import{T as be}from"./trash-2-B7mfE7cR.js";import"./sidebar-D72yRY0x.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-B15nK32a.js";import"./index-BURBo1Fb.js";import"./floating-ui.react-dom-DyVQx6GH.js";import"./x-BsD2Ph8w.js";import"./createLucideIcon-DQ0uzrfc.js";import"./tooltip-cMZakSlP.js";import"./nav-user-3DjZb-iD.js";import"./avatar-BZEWERC7.js";import"./dropdown-menu-ChwWV6C9.js";import"./check-D4vnSq3V.js";import"./chevron-right-C9Drcg-G.js";import"./file-text-DJosvJjd.js";import"./users-round-DYx1XjIx.js";import"./heart-pulse-Cq-MPyvz.js";import"./chevron-up-vstyJ82G.js";import"./breadcrumb-BhM0RIEr.js";import"./ellipsis-D8qtlaGc.js";import"./react-datepicker-DIEhyEna.js";import"./index-D98XC42S.js";import"./iconBase-sZqcdp0w.js";import"./index-CMRnMhaM.js";import"./index-CZwLc1Eb.js";import"./file-output-D8HmeCVk.js";function mt({medicalConditions:k,puroks:M,queryParams:r}){const T=[{label:"Medical Information",showOnMobile:!1},{label:"Medical Condition",showOnMobile:!0}];r=r||{};const I=de(),a=H().props,d=(a==null?void 0:a.success)??null,c=(a==null?void 0:a.error)??null,[O,m]=n.useState(!1),[g,R]=n.useState(null),[j,A]=n.useState(r.name??""),[L,p]=n.useState(!1),[N,w]=n.useState(null),F=e=>{if(!e)return"Unknown";const s=new Date(e),o=new Date;let i=o.getFullYear()-s.getFullYear();const l=o.getMonth()-s.getMonth();return(l<0||l===0&&o.getDate()<s.getDate())&&i--,i},U=e=>{e.preventDefault(),u("name",j)},u=(e,s)=>{s&&s.trim()!==""?r[e]=s:delete r[e],r.page&&delete r.page,h.get(route("medical_condition.index",r))},B=(e,s)=>{if(s.key==="Enter")u(e,s.target.value);else return},x=[{key:"id",label:"ID"},{key:"name",label:"Resident Name"},{key:"age",label:"Age"},{key:"sex",label:"Sex"},{key:"condition",label:"Condition"},{key:"status",label:"Status"},{key:"diagnosed_date",label:"Diagnosed Date"},{key:"resolved_date",label:"Resolved Date"},{key:"purok_number",label:"Purok Number"},{key:"actions",label:"Actions"}],[S,z]=n.useState(x.map(e=>e.key)),f=Object.entries(r||{}).some(([e,s])=>["purok","sex","age_group","condition_status"].includes(e)&&s&&s!=="");n.useEffect(()=>{f&&v(!0)},[f]);const[y,v]=n.useState(f),V={id:e=>e.id,name:e=>{const s=e.resident??{};return t.jsxs("span",{children:[s.firstname," ",s.middlename??""," ",s.lastname," ",s.suffix??""]})},sex:e=>{var l,D,_;const s=(l=e.resident)==null?void 0:l.sex,o=((D=re)==null?void 0:D[s])??s??"Unknown",i=((_=ne)==null?void 0:_[s])??"bg-gray-100 text-gray-800 px-2 py-1 rounded";return t.jsx("span",{className:`py-1 px-2 rounded-xl text-sm font-medium whitespace-nowrap ${i}`,children:o})},age:e=>{var o;const s=F((o=e.resident)==null?void 0:o.birthdate);return typeof s!="number"?"Unknown":t.jsxs("div",{className:"flex flex-col text-sm",children:[t.jsx("span",{className:"font-medium text-gray-800",children:s}),s>60&&t.jsx("span",{className:"text-xs text-rose-500 font-semibold",children:"Senior Citizen"})]})},condition:e=>e.condition??"—",status:e=>{const s=e.status,o=oe[s]??"Unknown",i=E[s]??E.default;return t.jsx("span",{className:i,children:o})},diagnosed_date:e=>e.diagnosed_date?new Date(e.diagnosed_date).toLocaleDateString():"—",resolved_date:e=>e.resolved_date?new Date(e.resolved_date).toLocaleDateString():"—",purok_number:e=>{var s;return((s=e.resident)==null?void 0:s.purok_number)??"—"},actions:e=>t.jsx(se,{actions:[{label:"View",icon:t.jsx(fe,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>{var s;return G((s=e.resident)==null?void 0:s.id)}},{label:"Edit",icon:t.jsx(he,{className:"w-4 h-4 text-green-500"}),onClick:()=>{var s,o;h.get(route("medical.edit",(o=(s=e==null?void 0:e.resident)==null?void 0:s.medical_information)==null?void 0:o.id))}},{label:"Delete",icon:t.jsx(be,{className:"w-4 h-4 text-red-600"}),onClick:()=>K(e.id)}]})},$=()=>{p(!1),w(null)},K=e=>{R(e),m(!0)},Y=()=>{h.delete(route("medical_condition.destroy",g),{onError:e=>{console.error("Validation Errors:",e);const s=Object.values(e).join("<br />");b.error("Validation Error",{description:t.jsx("span",{dangerouslySetInnerHTML:{__html:s}}),duration:3e3,closeButton:!0})}}),m(!1)},G=async e=>{try{const s=await J.get(`${I}/resident/showresident/${e}`);w(s.data.resident)}catch(s){console.error("Error fetching placeholders:",s)}p(!0)};return n.useEffect(()=>{d&&($(),b.success(d,{description:"Operation successful!",duration:3e3,closeButton:!0})),a.success=null},[d]),n.useEffect(()=>{c&&b.error(c,{description:"Operation failed!",duration:3e3,closeButton:!0}),a.error=null},[c]),t.jsxs(W,{children:[t.jsx(Q,{title:"Medical Information"}),t.jsxs("div",{children:[t.jsx(ee,{richColors:!0}),t.jsx(q,{breadcrumbs:T}),t.jsx("div",{className:"p-2 md:p-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-red-50 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-2 bg-red-100 rounded-full",children:t.jsx(Z,{className:"w-6 h-6 text-red-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Medical Condition Records"}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Manage and monitor residents’"," ",t.jsx("span",{className:"font-medium",children:"health conditions, treatments, and medications"}),". Use the tools below to search, filter, and export medical records."]})]})]})}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[t.jsx(ie,{allColumns:x,visibleColumns:S,setVisibleColumns:z,showFilters:y,toggleShowFilters:()=>v(e=>!e)}),t.jsx(pe,{url:"report/export-medcondition-pdf",queryParams:r,label:"Export Medical Condition Records as PDF",type:"pdf"})]}),t.jsx("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:t.jsxs("form",{onSubmit:U,className:"flex w-[380px] max-w-lg items-center space-x-1",children:[t.jsx(P,{type:"text",placeholder:"Search Condition or Resident Name",value:j,onChange:e=>A(e.target.value),onKeyDown:e=>B("name",e.target.value),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(C,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(ue,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]}),t.jsx("div",{className:"relative group z-50",children:t.jsxs(X,{href:route("medical.create"),children:[t.jsx(C,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",type:"button",children:t.jsx(xe,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Medical Information"})]})})]})})]}),y&&t.jsx(le,{queryParams:r,searchFieldName:u,visibleFilters:["purok","sex","age_group","condition_status"],puroks:M,showFilters:!0,clearRouteName:"medical_condition.index",clearRouteParams:{}}),t.jsx(te,{passedData:k,allColumns:x,columnRenderers:V,queryParams:r,visibleColumns:S,showTotal:!0})]})})}),t.jsx(ae,{isOpen:L,onClose:()=>p(!1),title:"Resident Details",children:N&&t.jsx(ce,{person:N})}),t.jsx(me,{isOpen:O,onClose:()=>{m(!1)},onConfirm:Y,residentId:g})]})]})}export{mt as default};

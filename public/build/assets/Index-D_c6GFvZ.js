import{K as he,r as o,m as xe,j as t,L as be,S as V,a as U}from"./app-OMiIBAVv.js";import ge from"./ActionMenu-BwZQbtv1.js";import _e from"./BreadcrumbsHeader-D7yXDAqZ.js";import fe from"./DynamicTable-UkXv7no2.js";import{B as g}from"./button-DSR4zr8t.js";import{I as je}from"./input-BGuCCM3F.js";import{S as ye,G as ve}from"./AdminLayout-CUYq8DRk.js";import{I as Ne,a as Ee}from"./index-CK7UpZTr.js";import{F as Se}from"./FillterToggle-DNCt5F0M.js";import Ce from"./DynamicTableControls-D0m5fsZs.js";import ke from"./PersonDetailContent-DPOW1tjr.js";import we from"./SidebarModal-BhCVnGdX.js";import{u as De}from"./useAppUrl-D_iSPAaw.js";import{I as Ae}from"./InputLabel-Cqcva6ji.js";import{I as _}from"./InputField-BN9Kcp6u.js";import{I as c}from"./InputError-LtgWhWIb.js";import{R as $e}from"./RadioGroup-Bx2v-oud.js";import{D as Y}from"./DropdownInputField-BkfrznIy.js";import{t as w,T as Oe}from"./index-0Qv22I-m.js";import{E as Re,j as Te,k as Fe}from"./constants-iESbBslm.js";import{u as Ie}from"./handleResidentChange-oP0FMrcp.js";import{S as Me}from"./SelectField-0PSr83-z.js";import{Y as B}from"./YearDropdown-DOrwhxOa.js";import He from"./DeleteConfirmationModal-TJ1uBlKB.js";import{E as Le}from"./ExportButton-D1HLyQQo.js";import{S as Ve}from"./search-B5GIhMYd.js";import{L as Ue}from"./list-plus-BMoEcxBa.js";import{R as Ye}from"./rotate-ccw-X1iZFrTN.js";import{M as Be}from"./move-right-OsZnL4gk.js";import{E as Pe}from"./eye-Wkg7vRqS.js";import{S as Ge}from"./square-pen-CIUQNKLN.js";import{T as ze}from"./trash-2-jR1sYQPd.js";import"./dropdown-menu-Bvu9yf_7.js";import"./index-CI6SsBKC.js";import"./index-BLQZ4u8d.js";import"./floating-ui.react-dom-CMRH_ZRG.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./check-CuPlmUjy.js";import"./createLucideIcon-Axl_0YCz.js";import"./chevron-right-Cy23RFOt.js";import"./tooltip-DovJGv4D.js";import"./ellipsis-PuzZ1_TO.js";import"./breadcrumb-BupgMzbl.js";import"./sidebar-8I0oMIHa.js";import"./x-CWRGpm6F.js";import"./skeleton-B3ns0wAt.js";import"./nav-user-CHo7Aeqf.js";import"./avatar-EoKRnGG_.js";import"./users-round-DM5XvS4t.js";import"./heart-pulse-BEye5CQy.js";import"./chevron-up-aIKK6lnp.js";import"./iconBase-DPQdzrdi.js";import"./index-DoFmE3hV.js";import"./index-vfhmNStI.js";import"./file-output-BYH2ausi.js";function Jt({educations:P,puroks:G,queryParams:l=null,residents:D}){const z=[{label:"Residents Information",showOnMobile:!1},{label:"Residents Education",showOnMobile:!0}];l=l||{};const A=De(),d=he().props,f=(d==null?void 0:d.success)??null,j=(d==null?void 0:d.error)??null,[$,K]=o.useState(l.name??""),X=e=>{e.preventDefault(),y("name",$)},y=(e,a)=>{a&&a.trim()!==""?l[e]=a:delete l[e],l.page&&delete l.page,V.get(route("education.index",l))},J=(e,a)=>{if(a.key==="Enter")y(e,a.target.value);else return},[Q,h]=o.useState(!1),[v,x]=o.useState(""),N=Object.entries(l||{}).some(([e,a])=>["purok","educational_attainment","educational_status","school_type","year_started","year_ended","latest_education"].includes(e)&&a&&a!=="");o.useEffect(()=>{N&&R(!0)},[N]);const E=[{key:"id",label:"Histoy ID"},{key:"name",label:"Name"},{key:"educational_attainment",label:"Educational Attainment"},{key:"education_status",label:"Education Status"},{key:"school_name",label:"School Name"},{key:"school_type",label:"School Type"},{key:"year_started",label:"Year Started"},{key:"year_ended",label:"Year Ended"},{key:"program",label:"Program (Course)"},{key:"purok_number",label:"Purok"},{key:"actions",label:"Actions"}],[O,R]=o.useState(N),[T,F]=o.useState(null),[m,S]=o.useState(null),[W,C]=o.useState(!1),[I,Z]=o.useState(null),q=E.map(e=>e.key),[b,ee]=o.useState(()=>{const e=localStorage.getItem("education_visible_columns");return e?JSON.parse(e):q});o.useEffect(()=>{localStorage.setItem("education_visible_columns",JSON.stringify(b))},[b]);const te=D.map(e=>({label:`${e.firstname} ${e.middlename} ${e.lastname} ${e.suffix??""}`,value:e.id.toString()})),ae=async e=>{x("view"),F(null);try{const a=await U.get(`${A}/resident/showresident/${e}`);F(a.data.resident)}catch(a){console.error("Error fetching placeholders:",a)}h(!0)},se={id:e=>e.id,name:e=>{const a=e==null?void 0:e.resident;return a?`${a.firstname??""} ${a.middlename??""} ${a.lastname??""} ${a.suffix??""}`.trim():"Unknown"},educational_attainment:e=>Re[e.educational_attainment]||"—",education_status:e=>{const a=e.education_status,s=Fe[a]||"N/A",p={graduated:"bg-green-100 text-green-800",enrolled:"bg-blue-100 text-blue-800",incomplete:"bg-yellow-100 text-yellow-800",dropped_out:"bg-red-100 text-red-800"}[a]||"bg-gray-100 text-gray-600";return t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${p}`,children:s})},school_name:e=>e.school_name??"—",school_type:e=>t.jsx("span",{className:`px-2 py-1 text-xs rounded ${e.school_type==="private"?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"}`,children:Te[e.school_type]??"—"}),year_started:e=>e.year_started??"—",year_ended:e=>e.year_ended??"—",program:e=>e.program??t.jsx("span",{className:"text-gray-400 italic",children:"N/A"}),purok_number:e=>{var a;return((a=e==null?void 0:e.resident)==null?void 0:a.purok_number)??"—"},actions:e=>t.jsx(ge,{actions:[{label:"View",icon:t.jsx(Pe,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>{var a;return ae((a=e==null?void 0:e.resident)==null?void 0:a.id)}},{label:"Edit",icon:t.jsx(Ge,{className:"w-4 h-4 text-green-500"}),onClick:()=>me(e==null?void 0:e.id)},{label:"Delete",icon:t.jsx(ze,{className:"w-4 h-4 text-red-600"}),onClick:()=>ue(e==null?void 0:e.id)}]})},{data:r,setData:i,post:M,errors:n,reset:H,clearErrors:oe}=xe({resident_id:null,resident_name:"",resident_image:null,birthdate:null,purok_number:null,educational_histories:[[]],history_id:null,_method:void 0}),le=Ie(D,i),ie=()=>{x("add"),h(!0)},re=e=>{e.preventDefault(),M(route("education.store"),{onError:()=>{console.error("Validation Errors:",n)}})},ne=e=>{e.preventDefault(),M(route("education.update",r.history_id),{onError:()=>{console.error("Validation Errors:",n)}})},L=()=>{h(!1),x(""),S(null),H(),oe()};o.useEffect(()=>{f&&(L(),w.success(f,{description:"Operation successful!",duration:3e3,closeButton:!0})),d.success=null},[f]),o.useEffect(()=>{j&&w.error(j,{description:"Operation failed!",duration:3e3,closeButton:!0}),d.error=null},[j]);const de=()=>{i("educational_histories",[...r.educational_histories||[],{}])},ce=e=>{const a=[...r.educational_histories||[]];a.splice(e,1),i("educational_histories",a),w.warning("History removed.",{duration:2e3})},u=(e,a,s,k)=>{const p=[...r[k]||[]];p[a]={...p[a],[s]:e.target.value},i(k,p)},me=async e=>{x("add"),S(null);try{const s=(await U.get(`${A}/education/history/${e}`)).data.history;S(s),i("resident_id",s.resident.id),i("resident_name",`${s.resident.firstname} ${s.resident.middlename} ${s.resident.lastname} ${s.resident.suffix??""}`),i("purok_number",s.resident.purok_number),i("birthdate",s.resident.birthdate),i("resident_image",s.resident.resident_picture_path),i("educational_histories",[{education:s.educational_attainment||"",education_status:s.education_status||"",school_name:s.school_name||"",program:s.program||"",school_type:s.school_type||"",year_ended:s.year_ended||"",year_started:s.year_started||""}]),i("history_id",s.id),i("_method","PUT")}catch(a){console.error("Error fetching placeholders:",a)}h(!0)},ue=e=>{Z(e),C(!0)},pe=()=>{V.delete(route("education.destroy",I)),C(!1)};return t.jsxs(ye,{children:[t.jsx(be,{title:"Resident Education"}),t.jsx(_e,{breadcrumbs:z}),t.jsx(Oe,{richColors:!0}),t.jsx("div",{className:"p-2 md:p-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:t.jsx(ve,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Education Records"}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Track resident education levels and related data. Use the tools below to",t.jsxs("span",{className:"font-medium",children:[" ","search, filter, and export"]})," ","education records for reports and community planning."]})]})]})}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[t.jsx(Ce,{allColumns:E,visibleColumns:b,setVisibleColumns:ee,showFilters:O,toggleShowFilters:()=>R(e=>!e)}),t.jsx(Le,{url:"report/export-education-excel",queryParams:l,label:"Export Resident Educations as XLSX"})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:X,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(je,{type:"text",placeholder:"Search Name",value:$,onChange:e=>K(e.target.value),onKeyDown:e=>J("name",e),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(g,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(Ve,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(g,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",onClick:ie,children:t.jsx(Ue,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add an Education"})]})]})]}),O&&t.jsx(Se,{queryParams:l,searchFieldName:y,visibleFilters:["purok","educational_attainment","educational_status","school_type","year_started","year_ended","latest_education"],puroks:G,showFilters:!0,clearRouteName:"education.index",clearRouteParams:{}}),t.jsx(fe,{passedData:P,allColumns:E,columnRenderers:se,queryParams:l,visibleColumns:b,showTotal:!0})]})})}),t.jsxs(we,{isOpen:Q,onClose:()=>{L()},title:v==="add"?m?"Edit Education History":"Add Education History":"View Resident Details",children:[v==="add"&&t.jsx("div",{className:"w-full rounded-xl border border-white/20 bg-white/10 backdrop-blur-md shadow-lg text-sm text-black p-4 space-y-4",children:t.jsxs("form",{onSubmit:m?ne:re,children:[t.jsx("h3",{className:"text-xl font-medium text-gray-700 mb-8",children:"Resident's Info"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-y-2 md:gap-x-4 mb-5 w-full",children:[t.jsxs("div",{className:"md:row-span-2 md:col-span-2 flex flex-col items-center space-y-2",children:[t.jsx(Ae,{htmlFor:"resident_image",value:"Profile Photo"}),t.jsx("img",{src:r.resident_image?`/storage/${r.resident_image}`:"/images/default-avatar.jpg",alt:"Resident Image",className:"w-32 h-32 object-cover rounded-full border border-gray-200"})]}),t.jsxs("div",{className:"md:col-span-4 space-y-2",children:[t.jsxs("div",{className:"w-full",children:[t.jsx(Y,{label:"Full Name",name:"resident_name",value:r.resident_name||"",placeholder:"Select a resident",onChange:e=>le(e),items:te,readOnly:m}),t.jsx(c,{message:n.resident_id,className:"mt-2"})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[t.jsx("div",{children:t.jsx(_,{label:"Birthdate",name:"birthdate",value:r.birthdate||"",readOnly:!0})}),t.jsx("div",{children:t.jsx(_,{label:"Purok Number",name:"purok_number",value:r.purok_number,readOnly:!0})})]})]})]}),t.jsxs("div",{className:"space-y-4 mt-4",children:[Array.isArray(r.educational_histories)&&r.educational_histories.map((e,a)=>t.jsxs("div",{className:"border p-4 mb-4 rounded-md relative bg-gray-50",children:[t.jsxs("div",{className:"grid md:grid-cols-3 gap-10 mt-4",children:[t.jsxs("div",{children:[t.jsx(Y,{label:"Educational Attainment",name:"education",value:e.education||"",onChange:s=>u(s,a,"education","educational_histories"),items:[{label:"No Education Yet",value:"no_education_yet"},{label:"No Formal Education",value:"no_formal_education"},{label:"Prep School",value:"prep_school"},{label:"Kindergarten",value:"kindergarten"},{label:"Elementary",value:"elementary"},{label:"High School",value:"high_school"},{label:"Senior High School",value:"senior_high_school"},{label:"College",value:"college"},{label:"ALS (Alternative Learning System)",value:"als"},{label:"TESDA",value:"tesda"},{label:"Vocational",value:"vocational"},{label:"Post Graduate",value:"post_graduate"}],placeholder:"Select your Educational Attainment"}),t.jsx(c,{message:n[`educational_histories.${a}.education`],className:"mt-2"})]}),t.jsxs("div",{children:[t.jsx(Me,{label:"Educational Status",name:"education_status",items:[{label:"Currently Enrolled",value:"enrolled"},{label:"Graduated",value:"graduated"},{label:"Incomplete",value:"incomplete"},{label:"Dropped Out",value:"dropped_out"}],selectedValue:e.education_status||"",onChange:s=>u(s,a,"education_status","educational_histories"),disabled:e.education==="no_formal_education"||e.education==="no_education_yet"}),t.jsx(c,{message:n[`educational_histories.${a}.education_status`],className:"mt-2"})]}),t.jsxs("div",{children:[t.jsx(_,{label:"School Name",name:"school_name",type:"text",value:e.school_name||"",onChange:s=>u(s,a,"school_name","educational_histories"),placeholder:"Enter school name",disabled:e.education==="no_formal_education"||e.education==="no_education_yet"}),t.jsx(c,{message:n[`educational_histories.${a}.school_name`],className:"mt-2"})]})]}),t.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mt-4",children:[t.jsxs("div",{children:[t.jsx($e,{label:"School Type",name:"school_type",options:[{label:"Public",value:"public"},{label:"Private",value:"private"}],selectedValue:e.school_type||"",onChange:s=>u(s,a,"school_type","educational_histories"),disabled:e.education==="no_formal_education"||e.education==="no_education_yet"}),t.jsx(c,{message:n[`educational_histories.${a}.school_type`],className:"mt-2"})]}),t.jsxs("div",{children:[t.jsx(B,{label:"Year Started",name:"year_started",value:e.year_started||"",onChange:s=>u(s,a,"year_started","educational_histories"),disabled:e.education==="no_formal_education"||e.education==="no_education_yet"}),t.jsx(c,{message:n[`educational_histories.${a}.year_started`],className:"mt-2"})]}),t.jsxs("div",{children:[t.jsx(B,{label:"Year Ended",name:"year_ended",value:e.year_ended||"",onChange:s=>u(s,a,"year_ended","educational_histories"),disabled:e.education==="no_formal_education"||e.education==="no_education_yet"}),t.jsx(c,{message:n[`educational_histories.${a}.year_ended`],className:"mt-2"})]}),e.education==="college"&&t.jsxs("div",{children:[t.jsx(_,{label:e.education_status==="graduated"?"Finished Course":"Current Course",name:"program",type:"text",value:e.program||"",onChange:s=>u(s,a,"program","educational_histories"),placeholder:"Enter your course",disabled:e.education==="no_formal_education"}),t.jsx(c,{message:n[`educational_histories.${a}.program`],className:"mt-2"})]})]}),m===null&&t.jsx("button",{type:"button",onClick:()=>ce(a),className:"absolute top-1 right-2 flex items-center gap-1 text-sm text-red-400 hover:text-red-800 font-medium mt-1 mb-5 transition-colors duration-200",children:t.jsx(Ne,{className:"text-2xl"})})]},a)),t.jsxs("div",{className:"flex justify-between items-center p-3",children:[m===null?t.jsxs("button",{type:"button",onClick:de,className:"flex items-center gap-1 text-sm mb-4 text-blue-600 hover:text-blue-800 font-medium mt-4 transition-colors duration-200",children:[t.jsx(Ee,{className:"text-2xl"}),t.jsx("span",{children:"Add Edicational History"})]}):t.jsx("div",{}),t.jsxs("div",{className:"flex justify-end items-center gap-2",children:[m==null&&t.jsxs(g,{type:"button",onClick:()=>H(),children:[t.jsx(Ye,{})," Reset"]}),t.jsxs(g,{className:"bg-blue-700 hover:bg-blue-400 ",type:"submit",children:[m?"Update":"Add"," ",t.jsx(Be,{})]})]})]})]})]})}),v==="view"&&T?t.jsx(ke,{person:T}):null]}),t.jsx(He,{isOpen:W,onClose:()=>{C(!1)},onConfirm:pe,residentId:I})]})}export{Jt as default};

import{K as he,r as l,m as be,j as e,L as ge,S as U,a as Y}from"./app-3hJRSR-U.js";import fe from"./ActionMenu-DA5mCRDS.js";import _e from"./BreadcrumbsHeader-CA4P7iEZ.js";import je from"./DynamicTable-DEqvTr_u.js";import{B as f}from"./button-DUtl5Jjy.js";import{I as ye}from"./input-DC1SVip5.js";import{S as ve,G as Ne}from"./AdminLayout-CMkRaBto.js";import{I as Ee,a as Se}from"./index-C3CSTcxo.js";import Ce from"./FillterToggle-Wduwfwy9.js";import ke from"./DynamicTableControls-zlltVskD.js";import we from"./PersonDetailContent-DngKTqFL.js";import De from"./SidebarModal-0crBg26A.js";import{u as Ae}from"./useAppUrl-Do5e-2xe.js";import{I as $e}from"./InputLabel-Z3V1We0m.js";import{I as _}from"./InputField-DD7kTjTH.js";import{I as c}from"./InputError-CzTVBQaq.js";import{R as Oe}from"./RadioGroup-gJg3gvzN.js";import{D as B}from"./DropdownInputField-DNeIoEU_.js";import{t as w,T as Re}from"./index-BN_piO4R.js";import{E as Te,j as Fe,k as He}from"./constants-Byjz8ljZ.js";import{u as Ie}from"./handleResidentChange-JXPe5yiQ.js";import{S as Me}from"./SelectField-BERVTgCn.js";import{Y as P}from"./YearDropdown-BB4BAwrL.js";import Le from"./DeleteConfirmationModal-CDmQshp3.js";import{E as G}from"./ExportButton-CzFNe6mS.js";import{t as Ve}from"./stringFormat-Dx_XIxG1.js";import{S as Ue}from"./search-BhHXccmb.js";import{L as Ye}from"./list-plus-CF26_OOz.js";import{R as Be}from"./rotate-ccw-CjZf9OPn.js";import{M as Pe}from"./move-right-BOwK9EBL.js";import{E as Ge}from"./eye-BXGV6yLH.js";import{S as ze}from"./square-pen-C_qxyj3E.js";import{T as Ke}from"./trash-2-BhdTiZZQ.js";import"./dropdown-menu-xqUv-ifZ.js";import"./index-BCWJfSDL.js";import"./index-CtJNCL1o.js";import"./floating-ui.react-dom-Dohp26gR.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./check-DoeJPBhS.js";import"./createLucideIcon-Dn3cR7Zy.js";import"./chevron-right-BA6XigVc.js";import"./tooltip-BhuOt-yH.js";import"./ellipsis-DYfBYJEG.js";import"./breadcrumb-BT2Ednb2.js";import"./sidebar-djYsJkPW.js";import"./x-BBeGo-fM.js";import"./nav-user-6pBx6Ts6.js";import"./avatar-C02IyeLk.js";import"./file-text-BEqJih8D.js";import"./users-round-DTwYczQW.js";import"./heart-pulse-BrJ3-jMX.js";import"./chevron-up-BA8rZG-c.js";import"./iconBase-C66PvLGm.js";import"./react-datepicker-K2FZ8Flc.js";import"./index-DiBLEkOC.js";import"./index-2rbIgCyb.js";import"./index-Dhzcrh1s.js";import"./file-output-DB7CO1VO.js";function qt({educations:D,puroks:z,queryParams:o=null,residents:A}){const K=[{label:"Residents Information",showOnMobile:!1},{label:"Residents Education",showOnMobile:!0}];o=o||{};const $=Ae(),d=he().props,j=(d==null?void 0:d.success)??null,y=(d==null?void 0:d.error)??null,[O,X]=l.useState(o.name??""),J=t=>{t.preventDefault(),v("name",O)},v=(t,a)=>{a&&a.trim()!==""?o[t]=a:delete o[t],o.page&&delete o.page,U.get(route("education.index",o))},Q=(t,a)=>{if(a.key==="Enter")v(t,a.target.value);else return},[W,h]=l.useState(!1),[N,b]=l.useState(""),E=Object.entries(o||{}).some(([t,a])=>["purok","educational_attainment","educational_status","school_type","year_started","year_ended","latest_education"].includes(t)&&a&&a!=="");l.useEffect(()=>{E&&T(!0)},[E]);const S=[{key:"id",label:"Histoy ID"},{key:"name",label:"Name"},{key:"educational_attainment",label:"Educational Attainment"},{key:"education_status",label:"Education Status"},{key:"school_name",label:"School Name"},{key:"school_type",label:"School Type"},{key:"year_started",label:"Year Started"},{key:"year_ended",label:"Year Ended"},{key:"program",label:"Program (Course)"},{key:"purok_number",label:"Purok"},{key:"actions",label:"Actions"}],[R,T]=l.useState(E),[F,H]=l.useState(null),[m,C]=l.useState(null),[Z,k]=l.useState(!1),[I,q]=l.useState(null),ee=S.map(t=>t.key),[g,te]=l.useState(()=>{const t=localStorage.getItem("education_visible_columns");return t?JSON.parse(t):ee});l.useEffect(()=>{localStorage.setItem("education_visible_columns",JSON.stringify(g))},[g]);const ae=A.map(t=>({label:`${t.firstname} ${t.middlename} ${t.lastname} ${t.suffix??""}`,value:t.id.toString()})),se=async t=>{b("view"),H(null);try{const a=await Y.get(`${$}/resident/showresident/${t}`);H(a.data.resident)}catch(a){console.error("Error fetching placeholders:",a)}h(!0)},oe={id:t=>t.id??"â€”",name:t=>{const a=t==null?void 0:t.resident;return a?Ve(`${a.firstname??""} ${a.middlename??""} ${a.lastname??""} ${a.suffix??""}`).trim()||e.jsx("span",{className:"text-gray-400 italic",children:"Not specified"}):e.jsx("span",{className:"text-gray-400 italic",children:"Unknown"})},educational_attainment:t=>Te[t.educational_attainment]??e.jsx("span",{className:"text-gray-400 italic",children:"Not specified"}),education_status:t=>{const a=t.education_status,s=He[a]||"N/A",x={graduated:"bg-green-100 text-green-800",enrolled:"bg-blue-100 text-blue-800",incomplete:"bg-yellow-100 text-yellow-800",dropped_out:"bg-red-100 text-red-800"}[a]||"bg-gray-100 text-gray-600";return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x}`,children:s})},school_name:t=>t.school_name??e.jsx("span",{className:"text-gray-400 italic",children:"Not specified"}),school_type:t=>{const a=t.school_type,s=Fe[a]??"Not specified",p=a==="private"?"bg-purple-100 text-purple-800":a==="public"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600";return e.jsx("span",{className:`px-2 py-1 text-xs rounded ${p}`,children:s})},year_started:t=>t.year_started??e.jsx("span",{className:"text-gray-400 italic",children:"Not specified"}),year_ended:t=>t.year_ended??e.jsx("span",{className:"text-gray-400 italic",children:"Not specified"}),program:t=>t.program??e.jsx("span",{className:"text-gray-400 italic",children:"Not specified"}),purok_number:t=>{var a;return((a=t==null?void 0:t.resident)==null?void 0:a.purok_number)??e.jsx("span",{className:"text-gray-400 italic",children:"Not specified"})},actions:t=>e.jsx(fe,{actions:[{label:"View",icon:e.jsx(Ge,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>{var a;return se((a=t==null?void 0:t.resident)==null?void 0:a.id)}},{label:"Edit",icon:e.jsx(ze,{className:"w-4 h-4 text-green-500"}),onClick:()=>ue(t==null?void 0:t.id)},{label:"Delete",icon:e.jsx(Ke,{className:"w-4 h-4 text-red-600"}),onClick:()=>pe(t==null?void 0:t.id)}]})},{data:r,setData:i,post:M,errors:n,reset:L,clearErrors:le}=be({resident_id:null,resident_name:"",resident_image:null,birthdate:null,purok_number:null,educational_histories:[[]],history_id:null,_method:void 0}),ie=Ie(A,i),re=()=>{b("add"),h(!0)},ne=t=>{t.preventDefault(),M(route("education.store"),{onError:()=>{console.error("Validation Errors:",n)}})},de=t=>{t.preventDefault(),M(route("education.update",r.history_id),{onError:()=>{console.error("Validation Errors:",n)}})},V=()=>{h(!1),b(""),C(null),L(),le()};l.useEffect(()=>{j&&(V(),w.success(j,{description:"Operation successful!",duration:3e3,closeButton:!0})),d.success=null},[j]),l.useEffect(()=>{y&&w.error(y,{description:"Operation failed!",duration:3e3,closeButton:!0}),d.error=null},[y]);const ce=()=>{i("educational_histories",[...r.educational_histories||[],{}])},me=t=>{const a=[...r.educational_histories||[]];a.splice(t,1),i("educational_histories",a),w.warning("History removed.",{duration:2e3})},u=(t,a,s,p)=>{const x=[...r[p]||[]];x[a]={...x[a],[s]:t.target.value},i(p,x)},ue=async t=>{b("add"),C(null);try{const s=(await Y.get(`${$}/education/history/${t}`)).data.history;C(s),i("resident_id",s.resident.id),i("resident_name",`${s.resident.firstname} ${s.resident.middlename} ${s.resident.lastname} ${s.resident.suffix??""}`),i("purok_number",s.resident.purok_number),i("birthdate",s.resident.birthdate),i("resident_image",s.resident.resident_picture_path),i("educational_histories",[{education:s.educational_attainment||"",education_status:s.education_status||"",school_name:s.school_name||"",program:s.program||"",school_type:s.school_type||"",year_ended:s.year_ended||"",year_started:s.year_started||""}]),i("history_id",s.id),i("_method","PUT")}catch(a){console.error("Error fetching placeholders:",a)}h(!0)},pe=t=>{q(t),k(!0)},xe=()=>{U.delete(route("education.destroy",I)),k(!1)};return e.jsxs(ve,{children:[e.jsx(ge,{title:"Resident Education"}),e.jsx(_e,{breadcrumbs:K}),e.jsx(Re,{richColors:!0}),e.jsx("div",{className:"p-2 md:p-4",children:e.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:e.jsx(Ne,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Education Records"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Track resident education levels and related data. Use the tools below to",e.jsxs("span",{className:"font-medium",children:[" ","search, filter, and export"]})," ","education records for reports and community planning."]})]})]})}),e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[e.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[e.jsx(ke,{allColumns:S,visibleColumns:g,setVisibleColumns:te,showFilters:R,toggleShowFilters:()=>T(t=>!t)}),e.jsx(G,{url:"report/export-education-excel",queryParams:o,label:"Export Resident Educations as XLSX"}),e.jsx(G,{url:"report/export-education-pdf",queryParams:o,label:"Export Education Histories as PDF",type:"pdf",totalRecords:D.total})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[e.jsxs("form",{onSubmit:J,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[e.jsx(ye,{type:"text",placeholder:"Search Name",value:O,onChange:t=>X(t.target.value),onKeyDown:t=>Q("name",t),className:"w-full"}),e.jsxs("div",{className:"relative group z-50",children:[e.jsx(f,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:e.jsx(Ue,{})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),e.jsxs("div",{className:"relative group z-50",children:[e.jsx(f,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",onClick:re,children:e.jsx(Ye,{className:"w-4 h-4"})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add an Education"})]})]})]}),R&&e.jsx(Ce,{queryParams:o,searchFieldName:v,visibleFilters:["purok","educational_attainment","educational_status","school_type","year_started","year_ended","latest_education"],puroks:z,showFilters:!0,clearRouteName:"education.index",clearRouteParams:{}}),e.jsx(je,{passedData:D,allColumns:S,columnRenderers:oe,queryParams:o,visibleColumns:g,showTotal:!0})]})})}),e.jsxs(De,{isOpen:W,onClose:()=>{V()},title:N==="add"?m?"Edit Education History":"Add Education History":"View Resident Details",children:[N==="add"&&e.jsx("div",{className:"w-full rounded-xl border border-white/20 bg-white/10 backdrop-blur-md shadow-lg text-sm text-black p-4 space-y-4",children:e.jsxs("form",{onSubmit:m?de:ne,children:[e.jsx("h3",{className:"text-xl font-medium text-gray-700 mb-8",children:"Resident's Info"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-y-2 md:gap-x-4 mb-5 w-full",children:[e.jsxs("div",{className:"md:row-span-2 md:col-span-2 flex flex-col items-center space-y-2",children:[e.jsx($e,{htmlFor:"resident_image",value:"Profile Photo"}),e.jsx("img",{src:r.resident_image?`/storage/${r.resident_image}`:"/images/default-avatar.jpg",alt:"Resident Image",className:"w-32 h-32 object-cover rounded-full border border-gray-200"})]}),e.jsxs("div",{className:"md:col-span-4 space-y-2",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(B,{label:"Full Name",name:"resident_name",value:r.resident_name||"",placeholder:"Select a resident",onChange:t=>ie(t),items:ae,readOnly:m}),e.jsx(c,{message:n.resident_id,className:"mt-2"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[e.jsx("div",{children:e.jsx(_,{label:"Birthdate",name:"birthdate",value:r.birthdate||"",readOnly:!0})}),e.jsx("div",{children:e.jsx(_,{label:"Purok Number",name:"purok_number",value:r.purok_number,readOnly:!0})})]})]})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[Array.isArray(r.educational_histories)&&r.educational_histories.map((t,a)=>e.jsxs("div",{className:"border p-4 mb-4 rounded-md relative bg-gray-50",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-10 mt-4",children:[e.jsxs("div",{children:[e.jsx(B,{label:"Educational Attainment",name:"education",value:t.education||"",onChange:s=>u(s,a,"education","educational_histories"),items:[{label:"No Education Yet",value:"no_education_yet"},{label:"No Formal Education",value:"no_formal_education"},{label:"Prep School",value:"prep_school"},{label:"Kindergarten",value:"kindergarten"},{label:"Elementary",value:"elementary"},{label:"High School",value:"high_school"},{label:"Senior High School",value:"senior_high_school"},{label:"College",value:"college"},{label:"ALS (Alternative Learning System)",value:"als"},{label:"TESDA",value:"tesda"},{label:"Vocational",value:"vocational"},{label:"Post Graduate",value:"post_graduate"}],placeholder:"Select your Educational Attainment"}),e.jsx(c,{message:n[`educational_histories.${a}.education`],className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(Me,{label:"Educational Status",name:"education_status",items:[{label:"Currently Enrolled",value:"enrolled"},{label:"Graduated",value:"graduated"},{label:"Incomplete",value:"incomplete"},{label:"Dropped Out",value:"dropped_out"}],selectedValue:t.education_status||"",onChange:s=>u(s,a,"education_status","educational_histories"),disabled:t.education==="no_formal_education"||t.education==="no_education_yet"}),e.jsx(c,{message:n[`educational_histories.${a}.education_status`],className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(_,{label:"School Name",name:"school_name",type:"text",value:t.school_name||"",onChange:s=>u(s,a,"school_name","educational_histories"),placeholder:"Enter school name",disabled:t.education==="no_formal_education"||t.education==="no_education_yet"}),e.jsx(c,{message:n[`educational_histories.${a}.school_name`],className:"mt-2"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(Oe,{label:"School Type",name:"school_type",options:[{label:"Public",value:"public"},{label:"Private",value:"private"}],selectedValue:t.school_type||"",onChange:s=>u(s,a,"school_type","educational_histories"),disabled:t.education==="no_formal_education"||t.education==="no_education_yet"}),e.jsx(c,{message:n[`educational_histories.${a}.school_type`],className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(P,{label:"Year Started",name:"year_started",value:t.year_started||"",onChange:s=>u(s,a,"year_started","educational_histories"),disabled:t.education==="no_formal_education"||t.education==="no_education_yet"}),e.jsx(c,{message:n[`educational_histories.${a}.year_started`],className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(P,{label:"Year Ended",name:"year_ended",value:t.year_ended||"",onChange:s=>u(s,a,"year_ended","educational_histories"),disabled:t.education==="no_formal_education"||t.education==="no_education_yet"}),e.jsx(c,{message:n[`educational_histories.${a}.year_ended`],className:"mt-2"})]}),t.education==="college"&&e.jsxs("div",{children:[e.jsx(_,{label:t.education_status==="graduated"?"Finished Course":"Current Course",name:"program",type:"text",value:t.program||"",onChange:s=>u(s,a,"program","educational_histories"),placeholder:"Enter your course",disabled:t.education==="no_formal_education"}),e.jsx(c,{message:n[`educational_histories.${a}.program`],className:"mt-2"})]})]}),m===null&&e.jsx("button",{type:"button",onClick:()=>me(a),className:"absolute top-1 right-2 flex items-center gap-1 text-sm text-red-400 hover:text-red-800 font-medium mt-1 mb-5 transition-colors duration-200",children:e.jsx(Ee,{className:"text-2xl"})})]},a)),e.jsxs("div",{className:"flex justify-between items-center p-3",children:[m===null?e.jsxs("button",{type:"button",onClick:ce,className:"flex items-center gap-1 text-sm mb-4 text-blue-600 hover:text-blue-800 font-medium mt-4 transition-colors duration-200",children:[e.jsx(Se,{className:"text-2xl"}),e.jsx("span",{children:"Add Edicational History"})]}):e.jsx("div",{}),e.jsxs("div",{className:"flex justify-end items-center gap-2",children:[m==null&&e.jsxs(f,{type:"button",onClick:()=>L(),children:[e.jsx(Be,{})," Reset"]}),e.jsxs(f,{className:"bg-blue-700 hover:bg-blue-400 ",type:"submit",children:[m?"Update":"Add"," ",e.jsx(Pe,{})]})]})]})]})]})}),N==="view"&&F?e.jsx(we,{person:F}):null]}),e.jsx(Le,{isOpen:Z,onClose:()=>{k(!1)},onConfirm:xe,residentId:I})]})}export{qt as default};

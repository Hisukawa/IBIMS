import{j as a,L as j,S as N}from"./app-1Ulo33cR.js";import{S as v,U as d}from"./AdminLayout-CgEQ-MOT.js";import F from"./BreadcrumbsHeader-CMB94YvU.js";import{B as E}from"./BarangayFilterCard-qlNmL_R5.js";import u from"./DynamicTable-LkESgc5B.js";import{T as p}from"./TableSection-CxASp8l4.js";import{N as A}from"./NoDataPlaceholder-CnTiIKSA.js";import"./sidebar-D4MJiJYy.js";import"./button-Dwc0dclq.js";import"./clsx-B-dksMZM.js";import"./utils-CkmPJWYF.js";import"./input-Ch6UbAXw.js";import"./index-EHQ60H1N.js";import"./index-D_B9yfGd.js";import"./floating-ui.react-dom-BdtgEX0V.js";import"./x-DdBsHjtD.js";import"./createLucideIcon-lg7BGEjz.js";import"./tooltip-DNKVLhHk.js";import"./nav-user-CZVgQQZ5.js";import"./avatar-B8lufsIp.js";import"./dropdown-menu-CygdrkB3.js";import"./check-Cm4yWAm8.js";import"./chevron-right-4sH-p9KV.js";import"./stringFormat-Dx_XIxG1.js";import"./useAppUrl-D28WZQb-.js";import"./index-C_WBzw8-.js";import"./DeleteConfirmationModal-CTSpiu8N.js";import"./file-text-DaWao37R.js";import"./users-round-zz5oswS3.js";import"./heart-pulse-a6F5h5IG.js";import"./chevron-up-C-oVtybp.js";import"./breadcrumb-D68v6IuP.js";import"./SelectField-Cb43m0SA.js";import"./card-o43IzILD.js";function le({familyAtRiskData:c=[],overallFamilyAtRiskData:b=[],barangays:h=[],selectedBarangay:m,tip:y}){const w=[{label:"CRA",showOnMobile:!0},{label:"Family at Risk",showOnMobile:!0}],f=Array.isArray(b)?b:Object.values(b||[]),g=e=>{const o=e.target.value;N.get(route("cdrrmo_admin.familiesatrisk"),o?{barangay_id:o}:{})},x=!m&&(!f||f.length===0)||m&&(!c||c.filter(e=>e.barangay_id===m).length===0);return a.jsxs(v,{children:[a.jsx(j,{title:"Family at Risk"}),a.jsx(F,{breadcrumbs:w}),a.jsx("div",{className:"pt-8 pb-2 min-h-screen bg-gray-50",children:a.jsx("div",{className:"mx-auto w-full",children:x?a.jsxs("div",{className:"w-full px-2 sm:px-4 lg:px-6",children:[" ",a.jsx(A,{tip:y||"Select a barangay or view overall data from the dropdown above."})]}):a.jsxs(a.Fragment,{children:[a.jsx(E,{selectedBarangay:m,handleBarangayChange:g,barangays:h}),f.length>0&&a.jsx(p,{icon:a.jsx(d,{}),color:"red",title:"Family at Risk - Overall",description:"Indicators for all barangays",tableProps:{component:u,passedData:f.map((e,o)=>{const s={no:o+1,barangay_name:e.barangay_name},l={"Number of Families with Access to Information (radio/TV/ newspaper/ social media, etc.)":"number_of_families_with_access_to_information","Number of Employed Individuals":"number_of_employed_individuals","Number of Families Aware of the Effects of Risks and Hazards":"number_of_families_aware_of_the_effects_of_risks_and_hazards","Number of Families with Access to Early Warning System":"number_of_families_with_access_to_early_warning_system","Number of Families who received Financial Assistance":"number_of_families_who_received_financial_assistance","Number of Informal Settler Families":"number_of_informal_settler_families"};return e.indicators.forEach(_=>{const t=l[_.indicator];t&&(s[t]=_.total_count??0)}),s}),allColumns:[{key:"no",label:"No."},{key:"barangay_name",label:"Barangay Name"},{key:"number_of_families_with_access_to_information",label:"Number of Families with Access to Information (radio/TV/newspaper/social media, etc.)"},{key:"number_of_employed_individuals",label:"Number of Employed Individuals"},{key:"number_of_families_aware_of_the_effects_of_risks_and_hazards",label:"Number of Families Aware of the Effects of Risks and Hazards"},{key:"number_of_families_with_access_to_early_warning_system",label:"Number of Families with Access to Early Warning System"},{key:"number_of_families_who_received_financial_assistance",label:"Number of Families who received Financial Assistance"},{key:"number_of_informal_settler_families",label:"Number of Informal Settler Families"},{key:"total",label:"Total"}],columnRenderers:{no:e=>a.jsx("span",{className:"font-semibold",children:e.no}),barangay_name:e=>a.jsx("span",{className:"font-semibold",children:e.barangay_name}),number_of_families_with_access_to_information:e=>a.jsx("span",{children:e.number_of_families_with_access_to_information??0}),number_of_employed_individuals:e=>a.jsx("span",{children:e.number_of_employed_individuals??0}),number_of_families_aware_of_the_effects_of_risks_and_hazards:e=>a.jsx("span",{children:e.number_of_families_aware_of_the_effects_of_risks_and_hazards??0}),number_of_families_with_access_to_early_warning_system:e=>a.jsx("span",{children:e.number_of_families_with_access_to_early_warning_system??0}),number_of_families_who_received_financial_assistance:e=>a.jsx("span",{children:e.number_of_families_who_received_financial_assistance??0}),number_of_informal_settler_families:e=>a.jsx("span",{children:e.number_of_informal_settler_families??0}),total:e=>{const o=Object.keys(e).filter(s=>s!=="no"&&s!=="barangay_name").reduce((s,l)=>s+(e[l]??0),0);return a.jsx("span",{className:"font-semibold",children:o})}},visibleColumns:["no","barangay_name","number_of_families_with_access_to_information","number_of_employed_individuals","number_of_families_aware_of_the_effects_of_risks_and_hazards","number_of_families_with_access_to_early_warning_system","number_of_families_who_received_financial_assistance","number_of_informal_settler_families","total"],showTotal:!0,tableHeight:"600px"}}),c.filter(e=>e.barangay_id===m).map(e=>{const o=["Number of Families with Access to Information (radio/TV/ newspaper/ social media, etc.)","Number of Employed Individuals","Number of Families Aware of the Effects of Risks and Hazards","Number of Families with Access to Early Warning System","Number of Families who received Financial Assistance","Number of Informal Settler Families"],s={};e.indicators.forEach(i=>{i.puroks.forEach(r=>{s[r.purok_number]||(s[r.purok_number]={purok_number:r.purok_number??"-"});const n=i.indicator.replace(/\s+/g,"_").toLowerCase();s[r.purok_number][n]=r.count??0})});const l=Object.values(s).map((i,r)=>({no:r+1,...i})),_=[{key:"purok_number",label:"Purok"},...o.map(i=>({key:i.replace(/\s+/g,"_").toLowerCase(),label:i})),{key:"total",label:"Total"}],t={purok_number:i=>a.jsx("span",{children:i.purok_number})};return o.forEach(i=>{const r=i.replace(/\s+/g,"_").toLowerCase();t[r]=n=>a.jsx("span",{children:n[r]??0})}),t.total=i=>{const r=o.map(n=>n.replace(/\s+/g,"_").toLowerCase()).reduce((n,k)=>n+(i[k]??0),0);return a.jsx("span",{className:"font-semibold",children:r})},a.jsx(p,{icon:a.jsx(d,{}),color:"red",title:`Family at Risk - ${e.barangay_name}`,description:"Purok-level indicators",tableProps:{component:u,passedData:l,allColumns:_,columnRenderers:t,visibleColumns:_.map(i=>i.key),showTotal:!0,tableHeight:"600px"}},`barangay-${e.barangay_id}`)})]})})})]})}export{le as default};

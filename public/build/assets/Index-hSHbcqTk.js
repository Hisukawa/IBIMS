import{K as G,r as a,j as e,L as J,$ as Q,S as d,a as P}from"./app-1D8iD4Bd.js";import{S as W}from"./AdminLayout-D2OUv8TI.js";import{B as E}from"./button-CIPAcQX6.js";import{I as Y}from"./input-kPHXScB2.js";import Z from"./BreadcrumbsHeader-DgXCu5t1.js";import{t as $,T as q}from"./index-CnZBewDf.js";import"./table-NJR0uV-x.js";import"./dropdown-menu-DHdyJ-GF.js";import ee from"./DynamicTable-DxKJ6gLe.js";import te from"./ActionMenu-CnIJmyJ6.js";import{G as se,J as re,K as ae,L as ne}from"./constants-DR68gslb.js";import"./react-datepicker-ByHHk_eC.js";import"./label-RAJ_fK-X.js";import{u as ie}from"./useAppUrl-i6TCu06O.js";import oe from"./FillterToggle-DXovjElf.js";import le from"./DynamicTableControls-B05vB3dW.js";import me from"./DeleteConfirmationModal-CegdaycO.js";import de from"./SidebarModal-BHqddiKh.js";import ce from"./PersonDetailContent-B_mLbqB1.js";import{E as R}from"./ExportButton-Cp0XZPjI.js";import{F as pe}from"./file-text-I2mjrmGk.js";import{S as ue}from"./search-BHnWT_Zh.js";import{L as xe}from"./list-plus-DnTa1_v-.js";import{E as fe}from"./eye-DasCN9Bd.js";import{S as he}from"./square-pen-BniISOEU.js";import{T as be}from"./trash-2-CC2d3MMs.js";import"./sidebar-Din6F5Y0.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-DdMSQcBT.js";import"./index-CqHJtAg4.js";import"./floating-ui.react-dom-C_drr5GO.js";import"./x-CBK5N6LO.js";import"./createLucideIcon-BiNpe3Fv.js";import"./tooltip-D3jKv7IU.js";import"./nav-user-BRbHpYkz.js";import"./avatar-afxv1LQ4.js";import"./users-round-D33dYjXx.js";import"./heart-pulse-C1qA0-se.js";import"./chevron-up-BVnRNQGF.js";import"./breadcrumb-B6RqPXZT.js";import"./chevron-right-HnAL0H-e.js";import"./check-DT87XVe5.js";import"./ellipsis-BYyF5agw.js";import"./index-C7nBWhXB.js";import"./iconBase-CE4aS9vF.js";import"./index-Cqb1DdZ_.js";import"./index-5iL19m2P.js";import"./file-output-DmfQFXj_.js";function bt({summons:S,queryParams:n,incident_types:O}){const A=[{label:"Katarungang Pambarangay",showOnMobile:!1},{label:"Summons",showOnMobile:!0}];n=n||{};const i=G().props,p=(i==null?void 0:i.success)??null,u=(i==null?void 0:i.error)??null,M=ie(),[y,I]=a.useState(n.name??""),[F,x]=a.useState(!1),[_,L]=a.useState(null),[B,w]=a.useState(!1),[N,v]=a.useState(null),U=t=>{t.preventDefault(),f("name",y)},k=async t=>{try{const s=await P.get(`${M}/resident/showresident/${t}`);v(s.data.resident)}catch(s){console.error("Error fetching placeholders:",s)}w(!0)},f=(t,s)=>{s&&s.trim()!==""?n[t]=s:delete n[t],n.page&&delete n.page,d.get(route("summon.index",n))},K=(t,s)=>{if(s.key==="Enter")f(t,s.target.value);else return},c=[{key:"id",label:"ID"},{key:"type_of_incident",label:"Type of Incident"},{key:"complainants",label:"Complainant(s)"},{key:"respondents",label:"Respondent(s)"},{key:"status",label:"Summon Status"},{key:"incident_date",label:"Incident Date"},{key:"hearing_info",label:"Hearing Details"},{key:"remarks",label:"Remarks"},{key:"issued_by",label:"Issued By"},{key:"actions",label:"Actions"}],[h,T]=a.useState(c.map(t=>t.key));a.useEffect(()=>{h.length===0&&T(c.map(t=>t.key))},[]);const[ge,je]=a.useState(!0),[Se,ye]=a.useState(!1),b=Object.entries(n||{}).some(([t,s])=>["incident_type","incident_date","summon_status","hearing_number","hearing_status"].includes(t)&&s&&s!=="");a.useEffect(()=>{b&&C(!0)},[b]);const[D,C]=a.useState(b),z={id:t=>t.id,type_of_incident:t=>{var s;return e.jsx("span",{className:"font-medium text-blue-600 hover:underline hover:cursor-pointer  text-wrap",onClick:()=>d.visit(route("blotter_report.show",t.blotter.id)),children:((s=t.blotter)==null?void 0:s.type_of_incident)??"—"})},complainants:t=>{var l,o;const s=((o=(l=t.blotter)==null?void 0:l.participants)==null?void 0:o.filter(r=>r.role_type==="complainant"))||[];return s.length===0?"—":e.jsx("div",{className:"flex flex-wrap gap-x-1 text-sm",children:s.map((r,g)=>{const j=r.resident?`${r.resident.firstname??""} ${r.resident.middlename??""} ${r.resident.lastname??""} ${r.resident.suffix??""}`.trim():r.name??r.display_name??"—";return e.jsxs("span",{className:"text-blue-600 hover:underline hover:cursor-pointer",onClick:()=>{var m;return k((m=r.resident)==null?void 0:m.id)},children:[j,g<s.length-1&&","]},r.id)})})},respondents:t=>{var l,o;const s=((o=(l=t.blotter)==null?void 0:l.participants)==null?void 0:o.filter(r=>r.role_type==="respondent"))||[];return s.length===0?"—":e.jsx("div",{className:"flex flex-wrap gap-x-1 text-sm",children:s.map((r,g)=>{const j=r.resident?`${r.resident.firstname??""} ${r.resident.middlename??""} ${r.resident.lastname??""} ${r.resident.suffix??""}`.trim():r.name??r.display_name??"—";return e.jsxs("span",{className:"text-red-600 hover:underline hover:cursor-pointer",onClick:()=>{var m;return k((m=r.resident)==null?void 0:m.id)},children:[j,g<s.length-1&&","]},r.id)})})},status:t=>e.jsx("span",{className:`px-2 py-1 text-sm rounded-lg ${ne[t.status]??"bg-gray-100 text-gray-700"}`,children:ae[t.status]}),incident_date:t=>{var s;return(s=t.blotter)!=null&&s.incident_date?new Date(t.blotter.incident_date).toLocaleDateString():"—"},hearing_info:t=>{const s=t.latest_take;return s?e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsxs("span",{className:"font-semibold text-gray-900",children:["Hearing ",s.session_number]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:s.hearing_date?new Date(s.hearing_date).toLocaleDateString():"No Date Set"}),e.jsx("span",{className:`text-xs ${re[s.session_status]}`,children:se[s.session_status]})]})]}):"—"},issued_by:t=>{var o;const s=(o=t.issued_by)==null?void 0:o.resident;if(!s)return"—";const l=`${s.firstname??""} ${s.middlename??""} ${s.lastname??""} ${s.suffix??""}`.trim();return e.jsx("span",{className:"text-wrap text-gray-600",children:l})},remarks:t=>e.jsx("span",{className:"line-clamp-2 text-gray-600 text-wrap",children:t.latest_take.session_remarks??"—"}),actions:t=>e.jsx(te,{actions:[{label:"View",icon:e.jsx(fe,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>d.visit(route("summon.show",t.blotter_id))},{label:"Edit",icon:e.jsx(he,{className:"w-4 h-4 text-green-500"}),onClick:()=>V(t.blotter_id)},{label:"Delete",icon:e.jsx(be,{className:"w-4 h-4 text-red-600"}),onClick:()=>X(t.id)}]})},X=t=>{L(t),x(!0)},H=()=>{d.delete(route("summon.destroy",_)),x(!1)},V=t=>{d.get(route("summon.elevate",t))};return a.useEffect(()=>{p&&$.success(p,{description:"Operation successful!",duration:3e3,closeButton:!0}),i.success=null},[p]),a.useEffect(()=>{u&&$.error(u,{description:"Operation failed!",duration:3e3,closeButton:!0}),i.error=null},[u]),e.jsxs(W,{children:[e.jsx(J,{title:"Blotter Reports Dashboard"}),e.jsx(Z,{breadcrumbs:A}),e.jsx(q,{richColors:!0}),e.jsx("div",{className:"pt-4",children:e.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 mb-6 bg-gray-50 rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(pe,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Summon Records"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Track and manage summons issued in relation to blotter cases. Monitor hearing schedules, statuses, and ensure proper documentation for transparent case resolution."})]})]}),e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[e.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[e.jsx(le,{allColumns:c,visibleColumns:h,setVisibleColumns:T,showFilters:D,toggleShowFilters:()=>C(t=>!t)}),e.jsx(R,{url:"report/export-summon-excel",queryParams:n,label:"Export Summon Records as XLSX"}),e.jsx(R,{url:"report/export-summon-pdf",queryParams:n,label:"Export Summon Summary as PDF",type:"pdf",totalRecords:S.total})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[e.jsxs("form",{onSubmit:U,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[e.jsx(Y,{type:"text",placeholder:"Search for Complainant",value:y,onChange:t=>I(t.target.value),onKeyDown:t=>K("name",t),className:"w-full"}),e.jsxs("div",{className:"relative group z-50",children:[e.jsx(E,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:e.jsx(ue,{})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),e.jsx(Q,{href:route("blotter_report.create"),children:e.jsxs("div",{className:"relative group z-50",children:[e.jsx(E,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:e.jsx(xe,{className:"w-4 h-4"})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Blotter Report"})]})})]})]}),D&&e.jsx(oe,{queryParams:n,searchFieldName:f,visibleFilters:["incident_type","incident_date","summon_status","hearing_number","hearing_status"],showFilters:!0,types:O,clearRouteName:"summon.index",clearRouteParams:{}}),e.jsx(ee,{passedData:S,columnRenderers:z,allColumns:c,visibleColumns:h,showTotal:!0}),e.jsx(de,{isOpen:B,onClose:()=>{w(!1),v(null)},title:"Resident Details",children:N&&e.jsx(ce,{person:N})}),e.jsx(me,{isOpen:F,onClose:()=>{x(!1)},onConfirm:H,residentId:_})]})})})]})}export{bt as default};

import{K as Y,r as a,j as t,L as W,$ as T,S as h,a as Q}from"./app-DluTzGHb.js";import J from"./BreadcrumbsHeader-Y2cXmDh4.js";import{S as Z}from"./AdminLayout-C6c7O0lg.js";import q from"./ActionMenu-Csrc1Y8-.js";import ee from"./DynamicTable-DoGyDRNI.js";import{B as x}from"./button-Dh7fzRxe.js";import{I as te}from"./input-CC5TkSWh.js";import{M as se,m as oe,H as ae,n as ie,o as le,p as re,R as ne,b as de}from"./constants-DMcup6PS.js";import ce from"./DynamicTableControls-BEolPDSu.js";import{F as me}from"./FillterToggle-DBEPxxLr.js";import ue from"./PersonDetailContent-DweGkZAM.js";import pe from"./SidebarModal-D5hk8Ket.js";import{u as he}from"./useAppUrl-D9cToTnc.js";import xe from"./DeleteConfirmationModal-BzlNGbtB.js";import{t as R,T as fe}from"./index-0PVT8G0g.js";import{H as ge}from"./users-round-D7LnzO6_.js";import{S as be}from"./search-9FvAwn6S.js";import{S as we}from"./share-2-D_mfeEVT.js";import{N as ye}from"./network-D8boEuWk.js";import{E as je}from"./eye-BV2fkW8i.js";import{S as _e}from"./square-pen-DT4IBfsq.js";import{X as Ne}from"./x-CrNk9GF0.js";import"./breadcrumb-CQ8mNh-X.js";import"./chevron-right-C0HBejuY.js";import"./createLucideIcon-Ax5zlIWT.js";import"./sidebar-DATaBsqm.js";import"./index-BRJrdTSG.js";import"./index-CYvM7WXr.js";import"./floating-ui.react-dom-B6VSRzGx.js";import"./skeleton-BJ7hj38Q.js";import"./tooltip-CysDY4zj.js";import"./clsx-B-dksMZM.js";import"./nav-user-hJFFRtgC.js";import"./avatar-B8ztu7IH.js";import"./dropdown-menu-BXZ3MBVH.js";import"./check-ZTEKtxjY.js";import"./chevron-up-DZw0GgUV.js";import"./ellipsis-DazvAe9f.js";import"./iconBase-BuSDbsmV.js";import"./index-BfWbB9AT.js";import"./index-Z_Y8QDqK.js";function pt({members:D,family_details:f,household_details:Se,queryParams:i=null}){const O=[{label:"Residents Information",showOnMobile:!1},{label:"Families",href:route("family.index"),showOnMobile:!1},{label:"View Family",showOnMobile:!0}],k=he();i=i||{};const l=Y().props,n=(l==null?void 0:l.success)??null,d=(l==null?void 0:l.error)??null,[g,I]=a.useState(i.name??""),C=e=>{e.preventDefault(),c("name",g)},c=(e,s)=>{s&&s.trim()!==""?i[e]=s:delete i[e],i.page&&delete i.page,h.get(route("family.showfamily",{family:f.id,...i}))},A=(e,s)=>{if(s.key==="Enter")c(e,s.target.value);else return},m=[{key:"resident_id",label:"Resident ID"},{key:"name",label:"Resident Name"},{key:"gender",label:"Gender"},{key:"age",label:"Age"},{key:"relationship_to_head",label:"Relationship to Head"},{key:"household_position",label:"Household Position"},{key:"employment_status",label:"Employment Status"},{key:"registered_voter",label:"Register Voter"},{key:"is_pwd",label:"Is PWD"},{key:"actions",label:"Actions"}],M=e=>{h.get(route("resident.edit",e))},[F,u]=a.useState(!1),[b,H]=a.useState(null),L=e=>{H(e),u(!0)},U=()=>{h.get(route("family.remove",b)),u(!1)},V=e=>{if(!e)return"Unknown";const s=new Date(e),o=new Date;let r=o.getFullYear()-s.getFullYear();const v=o.getMonth()-s.getMonth();return(v<0||v===0&&o.getDate()<s.getDate())&&r--,r},[$,w]=a.useState(!1),[y,z]=a.useState(null),P=async e=>{try{const s=await Q.get(`${k}/resident/showresident/${e}`);z(s.data.resident)}catch(s){console.error("Error fetching placeholders:",s)}w(!0)},[j,_]=a.useState(m.map(e=>e.key)),[X,Ee]=a.useState(!0),[N,B]=a.useState(!1),p=Object.entries(i||{}).some(([e,s])=>["gender","age_group","relation","household_position","estatus","voter_status","is_pwd"].includes(e)&&s&&s!=="All");a.useEffect(()=>{p&&E(!0)},[p]);const[S,E]=a.useState(p),G=()=>{window.print()},K={resident_id:e=>e.id,name:e=>`${e.firstname} ${e.middlename??""} ${e.lastname??""} ${e.suffix??""}`,gender:e=>{const s=e.gender,o=ne[s]??"Unknown",r=de[s]??"bg-gray-300";return t.jsx("span",{className:`py-1 px-2 rounded-xl text-sm font-medium ${r}`,children:o})},age:e=>{const s=V(e.birthdate);return typeof s!="number"?"Unknown":t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("span",{className:"font-medium text-gray-800",children:[s," years old"]}),s>60&&t.jsx("span",{className:"text-xs text-rose-600 font-semibold",children:"Senior Citizen"})]})},relationship_to_head:e=>{var s,o;return ie[(o=(s=e.household_residents)==null?void 0:s[0])==null?void 0:o.relationship_to_head]||""},household_position:e=>{var s,o;return ae[(o=(s=e.household_residents)==null?void 0:s[0])==null?void 0:o.household_position]||""},employment_status:e=>oe[e==null?void 0:e.employment_status],registered_voter:e=>{const s=(e==null?void 0:e.registered_voter)??0,o=le[s]??"Unknown",r=re[s]??"p-1 bg-gray-300 text-black rounded-lg";return t.jsx("span",{className:r,children:o})},is_pwd:e=>se[e==null?void 0:e.is_pwd],actions:e=>t.jsx(q,{actions:[{label:"View",icon:t.jsx(je,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>P(e.id)},{label:"Edit",icon:t.jsx(_e,{className:"w-4 h-4 text-green-500"}),onClick:()=>M(e.id)},{label:"Remove",icon:t.jsx(Ne,{className:"w-4 h-4 text-red-600"}),onClick:()=>L(e.id)}]})};return a.useEffect(()=>{n&&R.success(n,{description:"Operation successful!",duration:3e3,closeButton:!0}),l.success=null},[n]),a.useEffect(()=>{d&&R.error(d,{description:"Operation failed!",duration:3e3,closeButton:!0}),l.error=null},[d]),t.jsxs(Z,{children:[t.jsx(W,{title:"Family"}),t.jsx(J,{breadcrumbs:O}),t.jsx(fe,{richColors:!0}),t.jsx("div",{className:"pt-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:t.jsx(ge,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Family Details"}),t.jsx("p",{className:"text-sm text-gray-500",children:"View and manage the records of this specific family, including members, relationships, and household links."})]})]})}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:t.jsx(ce,{allColumns:m,visibleColumns:j,setVisibleColumns:_,onPrint:G,showFilters:S,toggleShowFilters:()=>E(e=>!e)})}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:C,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(te,{type:"text",placeholder:"Search for Household Member Name",value:g,onChange:e=>I(e.target.value),onKeyDown:e=>A("name",e),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(x,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(be,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),t.jsx(T,{href:route("family.create"),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(x,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(we,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Relationship"})]})}),t.jsx(T,{href:route("family.create"),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(x,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(ye,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Family Tree"})]})})]})]}),S&&t.jsx(me,{queryParams:i,searchFieldName:c,visibleFilters:["gender","age_group","relation","household_position","estatus","voter_status","is_pwd"],showFilters:!0,clearRouteName:"family.showfamily",clearRouteParams:{family:f.id}}),t.jsx(ee,{passedData:D,columnRenderers:K,allColumns:m,is_paginated:X,toggleShowAll:()=>B(!N),showAll:N,visibleColumns:j,setVisibleColumns:_})]})})}),t.jsx(pe,{isOpen:$,onClose:()=>w(!1),title:"Resident Details",children:y&&t.jsx(ue,{person:y})}),t.jsx(xe,{isOpen:F,onClose:()=>{u(!1)},onConfirm:U,residentId:b,title:"Confirm Removal",message:"Are you sure you want to remove resident from this household? This action cannot be undone.",buttonLabel:"I UNDERSTAND, REMOVE"})]})}export{pt as default};

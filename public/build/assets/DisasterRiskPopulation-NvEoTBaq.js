import{j as a,L as j,S as F}from"./app-B7OwNqSf.js";import{S as N,U as h}from"./AdminLayout-BD0jmJG3.js";import I from"./BreadcrumbsHeader-CEhD-SyH.js";import{B as T}from"./BarangayFilterCard-HXyOu_Gv.js";import r from"./DynamicTable-fIKOamNQ.js";import{T as u}from"./TableSection-DXbIHvvF.js";import{N as C}from"./NoDataPlaceholder-Dz6rhcZW.js";import{B as p}from"./button-DzGQWjub.js";import{F as c}from"./file-spreadsheet-Cxkzu0yS.js";import{T as z}from"./triangle-alert-BJ-vbw9Q.js";import"./sidebar-B2LvNkVW.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./input-dpCiH8RL.js";import"./index-CxXRfnYz.js";import"./index-CrQWsrME.js";import"./floating-ui.react-dom-YcL10O_d.js";import"./x-Cp3dml6P.js";import"./createLucideIcon-CVrtgvE4.js";import"./tooltip--eH8ikBw.js";import"./nav-user-4wNEANmQ.js";import"./avatar-Dm0-4Rk_.js";import"./dropdown-menu-BXQyzM78.js";import"./check-BRtnzyV0.js";import"./chevron-right-B-wNqjpS.js";import"./stringFormat-Dx_XIxG1.js";import"./useAppUrl-BrJCgO0b.js";import"./index-pmvy1wMQ.js";import"./DeleteConfirmationModal-D29aku5j.js";import"./file-text-BijKiEUA.js";import"./users-round-Bc2Y-r62.js";import"./heart-pulse-CATczoTT.js";import"./chevron-up-kIYVl4Hv.js";import"./breadcrumb-B9whiqIK.js";import"./SelectField-C6EfQzot.js";import"./card-C63JBOVQ.js";function hi({disasterRiskData:n=[],overallDisasterRiskData:d=[],overallHazardSummary:_=[],barangays:f=[],selectedBarangay:o,tip:b}){const v=[{label:"CRA",showOnMobile:!0},{label:"Disaster Risk Population",showOnMobile:!0}],g=i=>{const s=i.target.value;F.get(route("cdrrmo_admin.disasterpopulation"),s?{barangay_id:s}:{})},w=!o&&(!d||d.length===0)||o&&(!n||n.filter(i=>i.barangay_id===o).length===0),y=()=>{const i=sessionStorage.getItem("cra_year")||new Date().getFullYear(),e=`${window.location.origin}/cdrrmo_admin/cra/disaster-risk-population-summary/pdf?year=${i}`;window.open(e,"_blank")},x=i=>{const s=sessionStorage.getItem("cra_year")||new Date().getFullYear(),e=window.location.origin,t=encodeURIComponent(i),m=`${e}/cdrrmo_admin/cra/per-disaster-risk-population-summary/pdf?year=${s}&hazard=${t}`;window.open(m,"_blank")};return a.jsxs(N,{children:[a.jsx(j,{title:"Disaster Risk Population"}),a.jsx(I,{breadcrumbs:v}),a.jsx("div",{className:"pt-8 pb-2 min-h-screen bg-gray-50",children:a.jsxs("div",{className:"mx-auto w-full",children:[a.jsx(T,{selectedBarangay:o,handleBarangayChange:g,barangays:f}),w?a.jsx("div",{className:"w-full px-2 sm:px-4 lg:px-6",children:a.jsx(C,{tip:b||"Select a barangay or view overall data from the dropdown above."})}):a.jsxs(a.Fragment,{children:[_.length>0&&a.jsx(u,{icon:a.jsx(h,{}),color:"blue",title:"Overall Disaster Risk Population",description:"Total families and individuals affected by each hazard across all barangays.",tableProps:{component:r,passedData:_,allColumns:[{key:"no",label:"No."},{key:"hazard_name",label:"Hazard"},{key:"total_families",label:"Total Families"},{key:"total_individuals",label:"Total Individuals"},{key:"low_families",label:"Low Families"},{key:"medium_families",label:"Medium Families"},{key:"high_families",label:"High Families"},{key:"low_individuals",label:"Low Individuals"},{key:"medium_individuals",label:"Medium Individuals"},{key:"high_individuals",label:"High Individuals"}],columnRenderers:{no:i=>i.no,hazard_name:i=>a.jsx("span",{className:"font-semibold",children:i.hazard_name}),total_families:i=>i.total_families,total_individuals:i=>i.total_individuals,low_families:i=>i.low_families,medium_families:i=>i.medium_families,high_families:i=>i.high_families,low_individuals:i=>i.low_individuals,medium_individuals:i=>i.medium_individuals,high_individuals:i=>i.high_individuals},visibleColumns:["no","hazard_name","total_families","total_individuals","low_families","medium_families","high_families","low_individuals","medium_individuals","high_individuals"],showTotal:!0,tableHeight:"500px"},children:a.jsxs(p,{variant:"default",size:"sm",onClick:y,className:"bg-green-600 text-white hover:bg-green-700 ml-2",children:[a.jsx(c,{}),"Export Disaster Risk Population"]})}),d.length>0&&d.map((i,s)=>a.jsxs(u,{icon:a.jsx(h,{}),color:"blue",title:`Disaster Risk: ${i.hazard_name}`,description:`Total families and individuals affected by ${i.hazard_name} across barangays.`,tableProps:{component:r,passedData:i.barangays,allColumns:[{key:"no",label:"No."},{key:"barangay_name",label:"Barangay"},{key:"total_families",label:"Total Families"},{key:"total_individuals",label:"Total Individuals"},{key:"low_families",label:"Low Families"},{key:"medium_families",label:"Medium Families"},{key:"high_families",label:"High Families"},{key:"low_individuals",label:"Low Individuals"},{key:"medium_individuals",label:"Medium Individuals"},{key:"high_individuals",label:"High Individuals"}],columnRenderers:{no:e=>e.no,barangay_name:e=>a.jsx("span",{className:"font-semibold",children:e.barangay_name}),total_families:e=>e.total_families,total_individuals:e=>e.total_individuals,low_families:e=>e.low_families,medium_families:e=>e.medium_families,high_families:e=>e.high_families,low_individuals:e=>e.low_individuals,medium_individuals:e=>e.medium_individuals,high_individuals:e=>e.high_individuals},visibleColumns:["no","barangay_name","total_families","total_individuals","low_families","medium_families","high_families","low_individuals","medium_individuals","high_individuals"],showTotal:!0,tableHeight:"500px"},children:[" ",a.jsx("div",{className:"flex justify-end mt-2",children:a.jsxs(p,{variant:"destructive",size:"sm",onClick:()=>x(i.hazard_name),className:"ml-2",children:[a.jsx(c,{className:"mr-1 h-4 w-4"}),"Export ",i.hazard_name," Data"]})})]},s)),n.filter(i=>i.barangay_id===o).map(i=>i.hazards.map((s,e)=>{const t=(s.puroks||[]).map(l=>({purok_number:l.purok_number??"-",total_families:l.total_families??0,total_individuals:l.total_individuals??0,low_families:l.low_families??0,medium_families:l.medium_families??0,high_families:l.high_families??0,low_individuals:l.low_individuals??0,medium_individuals:l.medium_individuals??0,high_individuals:l.high_individuals??0})),m=[{key:"purok_number",label:"Purok"},{key:"total_families",label:"Total Families"},{key:"total_individuals",label:"Total Individuals"},{key:"low_families",label:"Low Families"},{key:"medium_families",label:"Medium Families"},{key:"high_families",label:"High Families"},{key:"low_individuals",label:"Low Individuals"},{key:"medium_individuals",label:"Medium Individuals"},{key:"high_individuals",label:"High Individuals"}],k={purok_number:l=>a.jsx("span",{className:"font-semibold",children:l.purok_number}),total_families:l=>a.jsx("span",{children:l.total_families}),total_individuals:l=>a.jsx("span",{children:l.total_individuals}),low_families:l=>a.jsx("span",{children:l.low_families}),medium_families:l=>a.jsx("span",{children:l.medium_families}),high_families:l=>a.jsx("span",{className:"text-red-600 font-semibold",children:l.high_families}),low_individuals:l=>a.jsx("span",{children:l.low_individuals}),medium_individuals:l=>a.jsx("span",{children:l.medium_individuals}),high_individuals:l=>a.jsx("span",{className:"text-red-600 font-semibold",children:l.high_individuals})};return a.jsx(u,{icon:a.jsx(z,{}),color:"red",title:`Disaster Risk Population - ${s.hazard_name}`,description:`Families and individuals affected by ${s.hazard_name} per purok.`,tableProps:{component:r,passedData:t,allColumns:m,columnRenderers:k,visibleColumns:m.map(l=>l.key),showTotal:!0,tableHeight:"500px"}},`hazard-${e}`)}))]})]})})]})}export{hi as default};

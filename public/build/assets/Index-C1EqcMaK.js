const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AdminLayout-BT7wF6Mc.js","assets/app-C4eYhi_l.js","assets/app-BzyfOfzR.css","assets/sidebar-B80sq0Kf.js","assets/button-DI-Cd1Gx.js","assets/clsx-B-dksMZM.js","assets/utils-CkmPJWYF.js","assets/input-B1v_GmYX.js","assets/index-DeJaiS9l.js","assets/index-DZeuKxhq.js","assets/floating-ui.react-dom-nJuhhlFk.js","assets/x-DGTK5KZy.js","assets/createLucideIcon-ix0d0rI9.js","assets/tooltip-D15WLvEi.js","assets/nav-user-D7t2WIAG.js","assets/avatar-WRU7l1Ef.js","assets/dropdown-menu-B0oOdoOV.js","assets/check-BP_4wZ21.js","assets/chevron-right-Cm2R-uMO.js","assets/stringFormat-Dx_XIxG1.js","assets/useAppUrl-B_lHPlr5.js","assets/index-BFcuYs35.js","assets/DeleteConfirmationModal-DcpGqNMw.js","assets/file-text-BhJx6_pw.js","assets/users-round-D6dnzBtP.js","assets/heart-pulse-C0ARj-oW.js","assets/chevron-up-BkPfmUJf.js","assets/SidebarModal-UVdBarpt.js","assets/PersonDetailContent-DCyJnjY4.js","assets/iconBase-zIHfGzTo.js","assets/index-ChzF1F1N.js","assets/constants-DxZHzEsj.js","assets/index-BmpNqgCc.js","assets/BreadcrumbsHeader-2D5rr_Ap.js","assets/breadcrumb-B0lL97FL.js","assets/DynamicTable-B4xGkgzX.js","assets/ActionMenu-CAWOW_NJ.js","assets/ellipsis-C7e4L9_n.js","assets/FillterToggle-Dvl0vonV.js","assets/react-datepicker-Ddc2XlFL.js","assets/index-B7sASRSJ.js","assets/react-datepicker-DdjxYr1F.css","assets/DynamicTableControls-CT7o_CTd.js","assets/ResidentCharts-D1KrqahJ.js","assets/ResponsiveContainer-vCn_692G.js","assets/CategoricalChart-yeCa8LUK.js","assets/string-BbYD24iH.js","assets/BarChart-C1IPAWM4.js","assets/Label-Cts08QGT.js","assets/CartesianGrid-Tg8ygEHG.js","assets/XAxis-Dwv5VB2O.js","assets/Tooltip-DRk_U8QD.js","assets/Legend-DqbNZyD6.js","assets/PieChart-CYfFvrii.js"])))=>i.map(i=>d[i]);
import{r as a,K as se,S as _,j as t,L as ae,$ as O,a as A,_ as n}from"./app-C4eYhi_l.js";import{B as b}from"./button-DI-Cd1Gx.js";import{I as re}from"./input-B1v_GmYX.js";import{t as d,T as oe}from"./index-BFcuYs35.js";import{n as ne,$ as ie,p as le,q as ce,R as de,c as ue}from"./constants-DxZHzEsj.js";import{u as me}from"./useAppUrl-B_lHPlr5.js";import{u as pe}from"./useQuery-B5qJm_k5.js";import{E as y}from"./ExportButton-CRF4WPjL.js";import{t as xe}from"./stringFormat-Dx_XIxG1.js";import{E as he}from"./eye-DeVIl6KK.js";import{F}from"./file-text-BhJx6_pw.js";import{S as fe}from"./square-pen-CGq9q169.js";import{T as _e}from"./trash-2-CzgJe0Yv.js";import{N as be}from"./network-B7k_Pm5T.js";import{U as ye}from"./users-round-D6dnzBtP.js";import{S as ge}from"./search-9s0GK8zN.js";import{H as je}from"./house-plus-B1RsjrT-.js";import{c as we}from"./createLucideIcon-ix0d0rI9.js";import"./clsx-B-dksMZM.js";import"./utils-CkmPJWYF.js";import"./index-DZeuKxhq.js";import"./file-output-CwQRJv9e.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M22 19h-6",key:"vcuq98"}]],ve=we("user-round-plus",Ee),Ne=a.lazy(()=>n(()=>import("./AdminLayout-BT7wF6Mc.js").then(i=>i.e),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]))),Te=a.lazy(()=>n(()=>import("./SidebarModal-UVdBarpt.js"),__vite__mapDeps([27,1,2,11,12]))),Se=a.lazy(()=>n(()=>import("./PersonDetailContent-DCyJnjY4.js"),__vite__mapDeps([28,1,2,29,30,31,32,25,12]))),Re=a.lazy(()=>n(()=>import("./BreadcrumbsHeader-2D5rr_Ap.js"),__vite__mapDeps([33,1,2,34,4,5,6,18,12,3,7,8,9,10,11,13]))),ke=a.lazy(()=>n(()=>import("./DynamicTable-B4xGkgzX.js"),__vite__mapDeps([35,1,2,12]))),De=a.lazy(()=>n(()=>import("./ActionMenu-CAWOW_NJ.js"),__vite__mapDeps([36,1,2,4,5,6,16,8,9,10,17,12,18,13,37]))),Ie=a.lazy(()=>n(()=>import("./FillterToggle-Dvl0vonV.js"),__vite__mapDeps([38,1,2,39,9,4,5,6,10,40,26,12,17,41,31,19]))),Pe=a.lazy(()=>n(()=>import("./DynamicTableControls-CT7o_CTd.js"),__vite__mapDeps([42,1,2,16,8,9,10,6,5,17,12,18,4]))),Ce=a.lazy(()=>n(()=>import("./DeleteConfirmationModal-DcpGqNMw.js"),__vite__mapDeps([22,1,2,21,9,11,12]))),Oe=a.lazy(()=>n(()=>import("./ResidentCharts-D1KrqahJ.js"),__vite__mapDeps([43,1,2,44,5,45,46,47,48,49,50,51,9,52,53]))),Ae=[{label:"Residents Information",showOnMobile:!1},{label:"Information Table",showOnMobile:!0}],g=[{key:"resident_id",label:"ID"},{key:"resident_picture",label:"Resident Image"},{key:"name",label:"Name"},{key:"sex",label:"Sex"},{key:"age",label:"Age"},{key:"civil_status",label:"Civil Status"},{key:"employment_status",label:"Employment"},{key:"occupation",label:"Occupation"},{key:"ethnicity",label:"Ethnicity"},{key:"registered_voter",label:"Registered Voter"},{key:"contact_number",label:"Contact Number"},{key:"email",label:"Email"},{key:"purok_number",label:"Purok"},{key:"actions",label:"Actions"}];function ot({residents:i,queryParams:u=null,puroks:L,ethnicities:M}){const r=a.useMemo(()=>u||{},[u]),{props:z}=se(),{success:m,error:p}=z,V=me();a.useEffect(()=>{m&&d.success(m,{description:"Operation successful!",duration:3e3,closeButton:!0}),p&&d.error(p,{description:"Operation failed!",duration:3e3,closeButton:!0})},[m,p]);const[j,$]=a.useState(r.name??""),U=a.useMemo(()=>{const e=[];return r.pwd==="1"&&e.push("PWD"),r.fourps==="1"&&e.push("FourPs"),r.solo_parent==="1"&&e.push("SoloParent"),e},[r.pwd,r.fourps,r.solo_parent]),{data:B,isLoading:q,isError:Fe}=pe({queryKey:["residents-chart",r],queryFn:async({signal:e})=>{const{data:s}=await A.get(`${V}/resident/chartdata`,{params:u,signal:e});return s.residents},enabled:!0,placeholderData:e=>e,staleTime:5*60*1e3,cacheTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1}),x=a.useMemo(()=>(e,s)=>{let o={...r};s&&s.trim()!==""&&s!=="0"?o[e]=s:delete o[e],delete o.page,_.get(route("resident.index",o),{preserveState:!0,replace:!0})},[r]),K=e=>{e.preventDefault(),x("name",j)},G=(e,s)=>{s.key==="Enter"&&x(e,s.target.value)},w=a.useMemo(()=>e=>{if(!e)return"Unknown";const s=new Date(e),o=new Date;let c=o.getFullYear()-s.getFullYear();const C=o.getMonth()-s.getMonth();return(C<0||C===0&&o.getDate()<s.getDate())&&c--,c},[]),E=e=>{_.get(route("resident.edit",e))},[H,v]=a.useState(!1),[N,Q]=a.useState(null),T=async e=>{try{const s=await A.get(route("resident.showresident",e));Q(s.data.resident)}catch(s){console.error("Error fetching resident details:",s),d.error("Failed to load resident details.",{description:s.message})}v(!0)},[S,X]=a.useState(g.map(e=>e.key)),h=a.useMemo(()=>Object.entries(r).some(([e,s])=>["purok","sex","gender","age_group","estatus","ethnic","voter_status","cstatus","pwd","fourps","solo_parent"].includes(e)&&s&&s!==""&&s!=="0"),[r]),[R,k]=a.useState(h);a.useEffect(()=>{k(h)},[h]);const[Y,f]=a.useState(!1),[l,W]=a.useState(null),D=e=>{W(e),f(!0)},I=e=>{const s=`/export-resident-pdf/${e}`;window.open(s,"_blank")},P=e=>{const s=`/export-resident-rbi/${e}`;window.open(s,"_blank")},J=a.useMemo(()=>()=>{l&&_.delete(route("resident.destroy",l),{onError:e=>{d.error("Failed to delete resident.",{description:e.message}),f(!1)}})},[l]),Z=a.useMemo(()=>({resident_id:e=>e.id,resident_picture:e=>t.jsx("img",{src:e.resident_picture?`/storage/${e.resident_picture}`:"/images/default-avatar.jpg",onError:s=>{s.target.onerror=null,s.target.src="/images/default-avatar.jpg"},alt:"Resident",className:"w-16 h-16 min-w-16 min-h-16 object-cover rounded-full border",loading:"lazy"}),name:e=>t.jsx("div",{className:"text-sm break-words whitespace-normal leading-snug",children:xe(`${e.firstname} ${e.middlename?e.middlename+" ":""}${e.lastname??""} ${e.suffix?e.suffix:""}`)}),sex:e=>{const s=e.sex,o=de[s]??"Unknown",c=ue[s]??"bg-gray-300";return t.jsx("span",{className:`py-1 px-2 rounded-xl text-sm font-medium whitespace-nowrap ${c}`,children:o})},age:e=>{const s=w(e.birthdate);return typeof s!="number"?"Unknown":t.jsxs("div",{className:"flex flex-col text-sm",children:[t.jsx("span",{className:"font-medium text-gray-800",children:s}),s>60&&t.jsx("span",{className:"text-xs text-rose-500 font-semibold",children:"Senior Citizen"})]})},civil_status:e=>ie[e.civil_status],employment_status:e=>ne[e.employment_status],occupation:e=>e.occupation?t.jsx("span",{className:"text-sm text-gray-700",children:e.occupation}):t.jsx("span",{className:"text-gray-400 text-[12px] italic",children:"No occupation available"}),ethnicity:e=>{const s=e.ethnicity;return s?t.jsx("span",{className:"text-sm text-gray-700",children:s}):t.jsx("span",{className:"text-gray-400 text-[12px] italic",children:"No ethnicity data"})},registered_voter:e=>{const s=e.registered_voter;return s!=null?t.jsx("span",{className:`${ce[s]} whitespace-nowrap`,children:le[s]}):t.jsx("span",{className:"text-gray-400 text-[12px] italic",children:"No voter data"})},contact_number:e=>{const s=e.contact_number;return s?t.jsx("span",{className:"whitespace-nowrap text-sm text-gray-700",children:s}):t.jsx("span",{className:"text-gray-400 text-[12px] italic whitespace-nowrap",children:"No contact number"})},purok_number:e=>e.purok_number,email:e=>{const s=e.email;return s?t.jsx("span",{className:"text-sm text-gray-700 whitespace-nowrap",children:s}):t.jsx("span",{className:"text-gray-400 text-[12px] italic whitespace-nowrap",children:"No email provided"})},actions:e=>t.jsx(De,{actions:[{label:"View",icon:t.jsx(he,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>T(e.id)},{label:"Export to PDF",icon:t.jsx(F,{className:"w-4 h-4 text-red-600"}),onClick:()=>I(e.id)},{label:"Export RBI Form B",icon:t.jsx(F,{className:"w-4 h-4 text-red-600"}),onClick:()=>P(e.id)},{label:"Edit",icon:t.jsx(fe,{className:"w-4 h-4 text-green-500"}),onClick:()=>E(e.id)},{label:"Delete",icon:t.jsx(_e,{className:"w-4 h-4 text-red-600"}),onClick:()=>D(e.id)},{label:"Family Tree",icon:t.jsx(be,{className:"w-4 h-4 text-blue-500"}),href:route("resident.familytree",e.id),tooltip:"See Family Tree"}]})}),[w,T,D,E,I,P]),[ee,te]=a.useState(r.all==="true");return a.useEffect(()=>{te(r.all==="true")},[r.all]),t.jsxs(Ne,{children:[t.jsx(ae,{title:"Resident"}),t.jsxs("div",{children:[t.jsx(oe,{richColors:!0}),t.jsx(Re,{breadcrumbs:Ae}),t.jsx("div",{className:"p-2 md:p-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-0",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsx(Oe,{residents:B??[],isLoading:q,welfareFilters:U}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[t.jsx(a.Suspense,{fallback:t.jsx("div",{children:"Loading Controls..."}),children:t.jsx(Pe,{allColumns:g,visibleColumns:S,setVisibleColumns:X,showFilters:R,toggleShowFilters:()=>k(e=>!e)})}),t.jsx(y,{url:"report/export-residents-excel",queryParams:r}),t.jsx(y,{url:"report/export-resident-pdf",queryParams:r,type:"pdf",totalRecords:i.total}),t.jsx(y,{url:"/report/export-monitoring-form-pdf",queryParams:r,type:"pdf",label:"Export Monitoring Form sa PDF",icon:t.jsx(ye,{})})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:K,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(re,{type:"text",placeholder:"Search",value:j,onChange:e=>$(e.target.value),onKeyDown:e=>G("name",e),className:"ml-4"}),t.jsxs("div",{className:"relative group z-5",children:[t.jsx(b,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(ge,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),t.jsx(O,{href:route("resident.create"),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(b,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(je,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Household"})]})}),t.jsx(O,{href:route("resident.createresident"),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(b,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(ve,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Resident"})]})})]})]}),R&&t.jsx(a.Suspense,{fallback:t.jsx("div",{children:"Loading Filters..."}),children:t.jsx(Ie,{queryParams:r,searchFieldName:x,visibleFilters:["purok","sex","gender","age_group","estatus","ethnic","voter_status","cstatus","pwd","fourps","solo_parent"],showFilters:!0,puroks:L,clearRouteName:"resident.index",clearRouteParams:{},ethnicities:M})}),t.jsx(a.Suspense,{fallback:t.jsx("div",{children:"Loading Table..."}),children:t.jsx(ke,{passedData:i,allColumns:g,columnRenderers:Z,showAll:ee,visibleColumns:S,showTotal:!0})})]})})})]}),t.jsx(Te,{isOpen:H,onClose:()=>v(!1),title:"Resident Details",children:N&&t.jsx(Se,{person:N})}),t.jsx(Ce,{isOpen:Y,onClose:()=>f(!1),onConfirm:J,residentId:l})]})}export{ot as default};
